                        DCEC PROTOCOL LABORATORY
                            INTERNET PROTOCOL
                              MIL-STD-1777
                        CERTIFICATION TESTS INDEX

This Certification Tests Index provides information on the derivation,
organization, and function of tests specified for Internet Protocol
(IP) within the DCEC Protocol Laboratory.

This document is divided into five sections:

      IP TRACEABILITY INDEX;

      IP TESTS INDEX;

      IP CODES INDEX;

      IP TEST SCENARIOS INDEX;

      and IP SCENARIOS AND TESTS DESCRIPTIONS.

                               --------


IP TRACEABILITY INDEX:  IP TEST NUMBERS versus IP MIL-STD-1777
References...

The table shows,  for MIL-STD-1777,  the IP Test Numbers which may be
regarded as the "principal  tests" of each required function,
operation, option, mode, response, or state.

                               --------


IP TESTS INDEX:   IP TEST NUMBERS versus IP Commands/Primitives/
Options/Modes...

The table shows the IP Test Numbers which may be regarded as the
"principal tests" of each IP Command or Primitive and/or Option or
Mode.

                               --------


IP CODES INDEX:   IP TEST NUMBERS versus IP Response Codes...

The table shows the IP  Test Numbers which may be regarded as the
"principal  tests" of each IP Response (or State, etc.) Code to/for/of
the indicated IP Commands or Primitives.

                               --------


IP TEST SCENARIOS INDEX:    IP TEST SCENARIO FILES versus IP TEST
NUMBERS...
The table shows, for each IP Test Number, the UNIX filenames of the I
Test Scenario Files in which it may be regarded as a "principal test
objective".

                               --------

IP SCENARIOS AND  TESTS DESCRIPTIONS...

This section provides a brief narrative of the scope and objectives of
each IP Test Scenario File and a narrative or graphic operational
description of each IP Test Number.
                         IP TRACEABILITY INDEX

IP TEST NUMBERS
    versus
        IP MIL-STD-1777 References

The following table shows, for MIL-STD-1777, the IP Test Numbers which
may be regarded as the "principal tests" of each required function,
operation, option, mode, response, or state.  Test Numbers not
indicated here may be used to establish necessary predecessor
conditions for these tests.

Reference                                     Test Number
---------                                     ----------------------

9.1                                           570-573, 2000-2099,
                                              2100-2142, 2200-2205,
                                              2904-2913

9.2.1                                         1100, 1108, 1113

9.2.1.1                                       801

9.2.1.1.1                                     801

9.2.1.1.2                                     1102

9.2.1.2                                       1101

9.2.1.2.1                                     1100, 1105, 1108,
                                              1113, 2100-2142, 3102

9.2.2                                         68, 500-525, 1024,
                                              1144

9.2.2.1                                       68, 1113, 1322

9.2.2.2                                       500-509, 517-525, 576

9.2.2.3                                       510-512

9.2.3                                         800-805

9.2.4                                         600-617

9.2.5                                         200-223, 300-315,
                                              400-410

9.2.6                                         1000-1047, 3000-3046

9.2.6.1                                       1113

9.3                                           804

Reference                                      Test Number
-----------                                    ----------------     
9.3.1                                          100, 101, 111

9.3.2                                          102-104, 111

9.3.3                                          200-223, 300-315

9.3.4                                          105-107, 111

9.3.5                                          0, 21845, 43690,
                                               65535

9.3.6                                          500, 570, 571

9.3.7                                          525, 573

9.3.8                                          600-617

9.3.9                                          801, 2903

9.3.10                                         800-805

9.3.11                                         801

9.3.12                                         801

9.3.13                                         1000-1047,  1101, 1109,
                                               1113, 1301, 1309,
                                               2000-2011, 3000-3046,
                                               4000-4011

9.3.13.1                                       1000-1047, 1101, 1109,
                                               1113, 1301, 1309,
                                               3000-3046

9.3.14                                         1000, 3000

9.3.15                                         2000-2099, 2200-2205,
                                               4000-4099, 4200-4205

9.3.15.1                                       1322, 3122

9.3.15.2                                       1001-1004, 3001-3004

9.3.15.3                                       1005-1012,  1322,
                                               2013-2026, 3005-3012,
                                               4013-4026

9.3.15.3.1                                     1005-1012, 3005-3012

9.3.15.3.2                                     578, 579
 
Reference                                      Test Numbers
---------                                      ----------------------          
9.3.15.3.3                                     580, 581

9.3.15.3.4                                     582, 583, 584

9.3.15.4                                       1101, 1102, 1105,
                                               1300, 2100-2119, 3100,
                                               3101, 3102, 4100-4119

9.3.15.5                                       1109, 1111, 1112,
                                               1308, 2120-2139, 3108,
                                               3109, 4120-4139

9.3.15.6                                       1113, 1315, 2043-2062,
                                               3122, 4043-4062

9.3.15.7                                       1013-1030, 2028-2039,
                                               3013-3030, 4028-4039

9.3.15.8                                       1036-1047, 2063-2099,
                                               3036-3046, 4063-4099

9.4.6.1.1                                      68, 801, 1144,
                                               4000-4099, 4100-4142

9.4.6.1.2                                      100-111, 500, 600-608,
                                               900, 2901-2903

9.4.6.1.3                                      500, 2970, 2972

9.4.6.1.4                                      510-512, 515-519

9.4.6.2.1                                      500

9.4.6.2.2                                      68, 1144

9.4.6.2.3                                      800-805

9.4.6.2.4                                      2902, 2903

9.4.6.2.5                                      1024, 1144

9.4.6.2.6                                      500-525

9.4.6.2.7                                      100-111

9.4.6.2.8                                      600-607

9.4.6.2.9                                      608-615, 4000-4099,
                                               4100-4142, 4200-4205

9.4.6.2.10                                     801, 1100

Reference                                     Test Numbers
-----------                                   ------------------------    
9.4.6.2.11                                    800, 1100, 1300, 2903

9.4.6.3.1                                     2900-2912, 2930-2934,
                                              2950-2969

9.4.6.3.2                                     68, 208-215, 308-315,
                                              801, 804, 3100

9.4.6.3.3                                     801, 804

9.4.6.3.4                                     2903

9.4.6.3.5                                     100-110, 512,
                                              2200-2205

9.4.6.3.6                                     2904-2912

9.4.6.3.7                                     1024, 1144

9.4.6.3.9                                     500-525, 574-585

9.4.6.3.10                                    500, 525

9.4.6.3.11                                    510-512, 515-519

9.4.6.3.12                                    801

9.4.6.3.13                                    1100-1121, 1300-1322,
                                              3100-3122
                          IP TESTS INDEX

IP TEST NUMBERS
    versus
        IP Commands/Primitives/Options/Modes

The following table shows the IP Test Numbers which may be
regarded as the "principal tests" of each IP Command or Primitive
and/or Option or Mode.  Test Numbers not indicated here may be
used to establish necessary predecessor conditions for these
tests.

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      ------------------

VERSION NUMBER            ==>                 100-101, 801

                          too small           100

                          too large           101

                          correct             801

INTERNET HEADER LENGTH    ==>                 102-104, 801

                          too large           102

                          too small           103

                          zero                104

                          correct             801

TYPE OF SERVICE           ==>                 200s, 300s, 400s

Gateway Testing           ==>                 400s

                          low delay
                          high reliability    400

                          low delay
                          high throughput     401

                          high reliability
                          maximum precedence  402

                          low delay
                          high reliability
                          maximum precedence  403

                          high throughput
                          maximum precedence  404

                          high throughput

Command or Primitive     Option or Mode      Test Number
-------------------      --------------      -----------------
                         high reliability
                         maximum precedence  405

                         low delay
                         low precedence      406

                         low delay
                         high reliability
                         low precedence      407

                         low delay
                         high throughput
                         high reliability
                         very low precedence 408

                         low delay
                         high throughput
                         high reliability
                         high precedence     409

                         low delay
                         high throughput
                         high reliability
                         maximum precedence  410

Precedence               ==>                 200s

  bottom-up (received
              by IUT)    ==>                 200-207

                         7                   200

                         6                   201

                         5                   202

                         4                   203

                         3                   204

                         2                   205

                         1                   206

                         0                   207

  top-down (sent by IUT) ==>                 208-215

                         7                   208

                         6                   209

Command or Primitive     Option or Mode      Test Number
--------------------     --------------      -----------------
                         5                   210

                         4                   211

                         3                   212

                         2                   213

                         1                   214

                         0                   215

  effect                 ==>                 216

Delay
Throughput
Reliability              ==>                 300s

  bottom-up (received
              by IUT)    =                   300-307

                         delay = 0
                         throughput = 0
                         reliability = 0     300

                         delay = 0
                         throughput = 0
                         reliability = 1     301

                         delay = 0
                         throughput = 1
                         reliability = 0     302

                         delay = 1
                         throughput = 0
                         reliability = 0     303

                         delay = 0
                         throughput = 1
                         reliability = 1     304

                         delay = 1
                         throughput = 0
                         reliability = 1     305

                         delay = 1
                         throughput = 1
                         reliability = 0     306

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      ------------------
                          delay = 1
                          throughput = 1
                          reliability = 1     307

  top-down (sent by IUT)  ==>                 308-315

                          delay = 0
                          throughput = 0
                          reliability = 0     315

                          delay = 0
                          throughput = 0
                          reliability = 1     314

                          delay = 0
                          throughput = 1
                          reliability = 0     313

                          delay = 1
                          throughput = 0
                          reliability = 0     312

                          delay = 0
                          throughput = 1
                          reliability = 1     311

                          delay = 1
                          throughput = 0
                          reliability = 1     310

                          delay = 1
                          throughput = 1
                          reliability = 0     309

                          delay = 1
                          throughput = 1
                          reliability = 1     308

TOTAL LENGTH              ==>                 105-107  801

                          too large           105

                          too small           106

                          excessively large   107

                          correct             801

IDENTIFICATION            ==>                 0,21845,43690,65535

                          bits clear each way 0

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      -------------------
                          bits set each way   65535

                          odd bits
                          set each way        43690

                          even bits
                          set each way        21845

                          bits clear to IUT
                          and set to Tester   65535

                          bits set to IUT
                          and clear to Tester 0

                          odd bits set to IUT
                          and even bits set
                          to Tester           21845

                          even bits set to IUT
                          and odd bits set
                          to Tester           43690

FLAGS & FRAGMENT OFFSET   ==>                 500s, 2970s

Normal                    ==>                 500-525, 2970, 2971

                          2 fragments         500

                          3 fragments         501

                          4 fragments         502

                          4 fragments where
                          second and third
                          are out of order    503

                          4 fragments in
                          reverse order       504

                          4 fragments that
                          are delayed within
                          relatively large
                          time to live limits 505

                          4 fragments that
                          are delayed within
                          relatively small
                          time to live limits 506

                          duplicate
                          header fragment     507

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      --------------------
                          duplicate
                          middle fragment     508

                          duplicate
                          tail fragment       509

                          missing
                          header fragment     510

                          missing
                          middle fragment     511

                          missing
                          tail fragment       512

                          simultaneous
                          reassembly          513-514

                          attempt
                          simultaneous
                          reassembly with
                          a missing fragment  515-516

                          indentification
                          separation          517

                          protocol
                          separation          518

                          middle fragment     519

                          reassemble a
                          576 byte datagram
                          split on 8 octet
                          boundaries          520

                          reassemble a
                          576 byte datagram
                          split on 16 octet
                          boundaries          521

                          reassemble a
                          576 byte datagram
                          split on 32 octet
                          boundaries          522

                          reassemble a
                          576 byte datagram
                          split on 64 octet
                          boundaries          523

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      ------------------
                          reassemble a
                          576 byte datagram
                          split on 128 octet
                          boundaries          524

                          reassemble a
                          576 byte datagram
                          split on 256 octet
                          boundaries          525

                          ICMP                2970

                          ICMP reverse order  2971

Abnormal                  ==>                 570-585, 2972, 2973

                          MF and DF set       570

                          DF set and
                          fragment offset
                          not 0               571

                          enormous
                          fragment offsets    572

                          range of
                          fragment offsets    573

                          precedence
                          mismatch            574

                          security level
                          mismatch with
                          unclassified
                          exception           575

                          classified security
                          level mismatch      576

                          security level
                          mismatch with
                          classified
                          exception           577

                          first
                          compartment byte
                          mismatch            578

                          second
                          compartment byte
                          mismatch            579

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      ------------------
                          first
                          handling byte
                          mismatch            580

                          second
                          handling byte
                          mismatch            581

                          first
                          transmission
                          control code byte
                          mismatch            582

                          second
                          transmission
                          control code byte
                          mismatch            583

                          third
                          transmission
                          control code byte
                          mismatch            584

                          security option
                          present exception   585

                          ICMP with bogus
                          ICMP fragments      2972

                          ICMP with a
                          fragment with a
                          time to live of 0   2973

TIME TO LIVE              ==>                 600s

bottom-up (received
             by IUT)      ==>                 600-608

                          0                   607

                          1                   608

                          20                  604

                          85 (odd bits set)   605

                          127                 603

                          128                 602

                          129                 601

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      ------------------
                          170 (even bits set) 606

                          255                 600

top-down (sent by IUT)    ==>                 609-617

                          0                   617

                          1                   616

                          20                  613

                          85 (odd bits set)   614

                          127                 612

                          128                 611

                          129                 610

                          170 (even bits set) 615

                          255                 609

PROTOCOL                  ==>                 574, 801, 2900s

Reassembly Mismatch       ==>                 574

Remote Driver             ==>                 801

Internet Control
Message Protocol          ==>                 2900s

  ICMP Echo Request       ==>                 2901-2903

                          bad header checksum 2901

                          bad ICMP checksum   2902

                          both checksums good 2903

                          fragmented          2970, 2971

  ICMP Parameter Problem ==>                  2904

  ICMP Redirect           ==>                 2950-2969

                          primer datagram
                          for host redirects 2950

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      ------------------
                          positive
                          host redirect       2951-2952

                          negative host and
                          type of service
                          redirect            2953-2954

                          host redirect and
                          host and type of
                          service redirect
                          independence        2955

                          negative
                          host redirect       2956, 2958

                          positive host and
                          type of service
                          redirect            2957, 2959

                          primer datagram for
                          network redirects   2960

                          positive
                          network redirect    2961-2962

                          negative network and
                          type of service
                          redirect            2963-2964

                          network redirect and
                          network and type of
                          service redirect
                          independence        2965

                          negative
                          network redirect    2966, 2968

                          positive network and
                          type of service
                          redirect            2967, 2969

  ICMP Source Quench      ==>                 2930-2934

                          primer datagram to
                          be sent by IUT so
                          it can be told to
                          quiet down          2930

                          Source Quenchs      2931-2934

  ICMP Timeout            ==>                 2905-2906

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      ------------------
                          time to live        2905

                          reassembly          2906

  ICMP Unreachable        ==>                 2907-2913

                          network             2907

                          host                2908

                          protocol            2909

                          port                2910

                          fragmentation       2911

                          source route        2912

                          send a normal IP
                          datagram for (are
                          you there?) check   2913

HEADER CHECKSUM           ==>                 800-805

                          too small           800

                          correct             801

                          too large           802

                          too small for IP
                          header with option  803

                          correct for IP
                          header with option  804

                          too large for IP
                          header with option  805

SOURCE ADDRESS            ==>                 801

DESTINATION ADDRESS       ==>                 801, 900, 2952

OPTIONS                   ==>                 1000-1047, 1100-1121,
                                              1300-1323, 2000-2099,
                                              2100-2142, 2200-2205,
                                              3000-3046, 3100-3122,
                                              4000-4099, 4100-4142,
                                              4200-4205

Bad Routing               ==>                 2100-2142, 4100-4142

Command or Primitive      Option or Mode      Test Number
--------------------      --------------      ------------------
   bottom-up              ==>                 2100-2142

   top-down               ==>                 4100-4142

Gateway Routing           ==>                 1100-1121

Host Routing              ==>                 1300-1323, 3100-3122

   bottom-up              ==>                 1300-1323

   top-down               ==>                 3100-3122

Missing Option Length     ==>                 2200-2205, 4200-4205

   bottom-up              ==>                 2200-2205

   top-down               ==>                 4200-4205

Non-Routing               ==>                 1000-1047, 2000-2099,
                                              3000-3046, 4000-4099

  bottom-up               ==>                 1000-1047, 2000-2099

   Bad                    ==>                 2000-2099

   Good                   ==>                 1000-1047

  top-down                ==>                 3000-3046, 4000-4099

   Bad                    ==>                 4000-4099

   Good                   ==>                 3000-3046

DATA                      ==>                 68, 576, 1024,  1144

                          send a 68
                          byte datagram       68

                          receive a 576
                          byte datagram       576

                          send a 1024
                          byte datagram       1024

                          send an 1144
                          byte datagram       1144
                          IP CODES INDEX

IP TEST NUMBERS
    versus
        IP Response Codes

The following table shows the IP Test Numbers which may be
regarded as the "principal tests" of each IP Response (or State,
etc.) Code to/for/of the indicated IP Commands or Primitives.
Test Numbers not indicated here may be used to establish
necessary predecessor conditions for these tests.

Response Code       Command or Primitive      Test Number
--------------      --------------------      ------------------

datagram            datagram                  801

datagram with
end of option
list option         datagram                  1000

datagram with
no operation
option              datagram                  1001

datagram with
security
option              datagram                  1005

datagram with
loose source and
record route
option              datagram                  1100, 3100

datagram with
strict source and
record route
option              datagram                  1108, 3108

datagram with
record route
option              datagram                  1113, 3122

datagram with
stream ID
option              datagram                  1029

datagram with
timestamp
option              datagram                  1113, 1117, 1119,
                                              3036, 3040, 3044

fragmented
datagram            datagram                  1024, 1144

Response Code        Command or Primitive     Response Code
---------------      --------------------     ------------------

ICMP Destination
Unreachable
   message           datagram                 900,  1105, 1112

ICMP Echo Reply      ICMP Echo Request
   message               message              2903

ICMP Parameter
   Problem
   message           datagram                 100, 570, 2200

ICMP Time Exceeded
   message           datagram                 511, 608
                   IP TEST SCENARIOS INDEX

IP TEST SCENARIO FILES
    versus
        IP TEST NUMBERS

Within the PROTOLAB VAX-11/750 Test Master System, all IP test
Scenario Files may be found in the following UNIX directory;;

     /usr/users/TSL/test/ip

The following table shows, for each IP Test Number, the UNIX
filenames of the IP test Scenario Files in which it may be
regarded as a "principal test objective".   A Test Number may be
used, to establish necessary predecessor conditions for other
Test Numbers, in Scenario Files not indicated here.

Test Number               Scenario File
-----------------------   ---------------------------------------------

0                         IdentTest

68                        Send68Test

100-111                   BadHeaderTest

200-207                   PrecBotTest

208-215                   PrecTopTest

216-223                   PrecEffTest

300-307                   TOS_BitBotTest

308-315                   TOS_BitTopTest

400-410                   TOS_GateTest

500-525                   ReasMustTest

570-585                   OddReasTest

576                       Send576Test

576                       Whole576Test

600-606                   TTLGdBotTest

607-608                   TTLBdBotTest

609-615                   TTLGdTopTest

Test Number               Scenario File
-----------               -------------

616-617                   TTLBdTopTest

800-805                   HdrCksumTest

900                       BadDestTest

1000-1047                 OptGdBotTest

1024                      Send1024Test

1100                      OpGlSrcBotTest

1101                      OpG2SrcBotTest

1102                      OpG2SrcBotTest

1103                      OpG3SrcBotTest

1104                      OpG3SrcBotTest

1105                      OpG2SrcBotTest

1106                      OpG6SrcBotTest

1107                      OpG3SrcBotTest

1108                      OpGlSrcBotTest

1109                      OpG2SrcBotTest

1110                      OpG3SrcBotTest

1111                      OpG2SrcBotTest

1112                      OpG2SrcBotTest

1113                      OpG1SrcBotTest

1114                      OpG1SrcBotTest

1115                      OpG2SrcBotTest

1116                      OpG2SrcBotTest

1117                      OpG2SrcBotTest

1118                      OpG2SrcBotTest

1119                      OpG2SrcBotTest

Test Number               Scenario File
-----------               ---------------

1120                      OpG2SrcBotTest

1121                      OpG6SrcBotTest

1144                      Send1144Test

1300                      OpG1DstBotTest

1301                      OpG2DstBotTest

1303                      OpG3DstBotTest

1306                      OpG6DstBotTest

1307                      OpG3DstBotTest

1308                      OpG1DstBotTest

1309                      OpG2DstBotTest

1310                      OpG3DstBotTest

1311                      OpG2DstBotTest

1312                      OpG3DstBotTest

1313                      OpG1DstBotTest

1314                      OpG1DstBotTest

1315                      OpG2DstBotTest

1316                      OpG2DstBotTest

1317                      OpG2DstBotTest

1318                      OpG2DstBotTest

1319                      OpG2DstBotTest

1320                      OpG2DstBotTest

1321                      OpG2DstBotTest

1322                      OpG1DstBotTest

1323                      OpG2DstBotTest

2000-2099                 OptBdBotTest

Test Number               Scenario File
-----------               ---------------

2100-2142                 OpBdRouBotTest

2200-2205                 NoOpLenBotTest

2900-2913                 ICMPart1Test

2930-2934                 ICMPSrcQueTest

2950-2969                 ICMPRedrctTest

2970-2974                 ICMPReasTest

3000-3046                 OptGdTopTest

3100                      OpGlSrcTopTest

3101                      OpG2SrcTopTest

3102                      OpG2SrcTopTest

3103                      OpG3SrcTopTest

3106                      OpG6SrcTopTest

3108                      OpG1SrcTopTest

3109                      OpG2SrcTopTest

3110                      OpG3SrcTopTest

3113                      OpG1SrcTopTest

3114                      OpG1SrcTopTest

3115                      OpG2SrcTopTest

3116                      OpG2SrcTopTest

3117                      OpG2SrcTopTest

3118                      OpG2SrcTopTest

3119                      OpG2SrcTopTest

3120                      OpG2SrcTopTest

3122                      OpG1SrcTopTest

4000-4099                 OptBdTopTest

Test Number               Scenario File
-----------               ---------------

4100-4142                 OpBdRouTopTest

4200-4205                 NoOpLenTopTest

21845                     IdentTest

43690                     IdentTest

65535                     IdentTest
                IP SCENARIOS AND TESTS DESCRIPTIONS

WARNING:  An implementation may only be denied certification if
it does not conform to MIL-STD-1777 or to the Internet Protocol
Remote Driver Specification. These specifications, interpreted as
required by law, are the final authorities.

While an effort has been made to identify every conceivable legal
response sanctified by the MIL-STD, implementors are invited to
explain their non-matching responses using the MIL-STD.

NOTICE: Many tests are intended to be controversial in order to
induce the Department of Defense to clarify MIL-STD-1777.

Scenario File BadDestTest: "Bad Destination Address" datagram

900       destination address doesn't match host's

------------------------------

Test 900 destination address doesn't match host's

     -Can the IUT detect that datagram isn't meant for it?

     -Action:  Send a datagram from the IP Tester to the host IP
     Implementation Under Test whose destination address
     indicates that it is for another host. The IUT should
     discard the datagram. It may send an ICMP Unreachable Host
     message to the IP Tester.

     -Verification: If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     DESTINATION UNREACHABLE ID=00900 HOST". The string "ident =
     900" should not appear in the display of the response
     datagram because this would indicate that the datagram was
     passed by the IUT to its Remote Driver.

     Success: An Internet Control Message Protocol (ICMP)
     Unreachable Most message displayed by the IP Tester. The
     total lack of an IP Tester response datagram display is also
     an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 900".

Scenario File BadHeaderTest: "Bad Header Value" datagrams

100       version number is 3

101       version number is 5

102       internet header length excessive
103       internet header length short

104       internet header length is 0

105       total length exceeds SNP length

106       total  length less than SNP length

107       total length vastly exceeds SNP length

108       truncated datagram with unadjusted checksum

109       truncated datagram with adjusted checksum

110       total length less than minimum IP header length

111       perfectly legal datagram

------------------------------

Test 100 version number too small

     -Can the IUT detect a bad version number?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test whose sole defect is a version
     number that is illegally small. This error should be caught
     by the IUT. The IUT may send an ICMP Parameter Problem
     message to   the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=00100". The string "ident = 100" should
     not appear in the display of the response datagram because
     this would indicate that the datagram was passed by the IUT
     to its Remote Driver.

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 100".

Test 101 version number too large

     -Can the IUT detect a bad version number?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test whose sole defect is a version
     number that is illegally large. This error should be caught
     by the IUT. The IUT may send an ICMP Parameter Problem
     message to the IP Tester.
     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=00101". The string "ident = 101" should
     not appear in the display of the response datagram because
     this would indicate that the datagram was passed by the IUT
     to its Remote Driver.

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 101".

Test 102 internet header length too large

     -Can the IUT detect a bad header length?

     -Action:  Send a datagram from the IP Tester to the IP        -
     Implementation Under Test whose sole defect is an internet
     header length that is illegally large because it indicates
     that the IP header exceeds the size of the IP datagram. This
     error should be caught by the IUT. The IUT may send an ICMP
     Parameter Problem message to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=00102". The string "ident = 102" should
     not appear in the display of the response-datagram because
     this would indicate that the datagram was passed by the IUT
     to its Remote Driver.

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 102".

Test 103 internet header length too small

     -Can the IUT detect a bad header length?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test whose sole defect is an internet
     header length that is illegally small because it is less
     than 5. This error should be caught by the IUT. The IUT may
     send an ICMP Parameter Problem message to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=00103". The string "ident = 103" should
     not appear in the display of the response datagram
     because this would indicate that the datagram was passed by
     the IUT to its Remote Driver.

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 103".

Test 104 internet header length equal to zero

     -Can the IUT detect a bad header length?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test whose sole defect is an illegally
     small internet header length of zero. This error should be
     caught by the IUT. The IUT may send an ICMP Parameter
     Problem message to the IP Tester.

     This test differs from Test 103 because an internet header
     length of zero is used in an attempt to induce an infinite
     loop in the IUT when forming an ICMP Parameter Problem
     message.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=00104". The string "ident = 104" should
     not appear in the display of the response datagram because
     this would indicate that the datagram was passed by the IUT
     to its Remote Driver.

     Infinite loop avoidance is indicated by a successful
     response to Test 111, or Test 576 in Whole576Test if that
     test is run last. In fact, any test that requires the IUT to
     send a missive to the IP Tester may be used to indicate that
     the IUT didn't get hung up in an infinite loop or crash.

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 104".

Test 105 total length exceeds actual length of IP datagram

     -Can the IUT detect a bad total length?

     -Action:  Send a datagram from the IP Tester to the IP
     implementation Under Test whose sole defect is a total
     length that indicates that the IP datagram is a byte longer
     than it actually is. Unless informed otherwise, the lab
     should consider this a section 9.4.6.2.7 error condition.
     The IUT may send an ICMP Parameter Problem message to the IP
     Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=00105". The string "ident = 105" should
     not appear in the di;play of the response datagram because
     this would indicate that the datagram was passed by the IUT
     to its Remote Driver.

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 105".

Test 106 total length less than actual length of IP datagram

     -Can the IUT detect a bad total length?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test whose sole defect is a total
     length that indicates that the IP datagram is a byte shorter
     than it actually is. Unless informed otherwise, the lab
     should consider this a section 9.4.6.2.7 error condition.
     The IUT may send an ICMP Parameter Problem message to the IP
     Tester.

     -Verification: If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=OOl06". The string "ident = 106" should
     not appear in the display of the response datagram because
     this would indicate that the datagram was passed by the IUT
     to its Remote Driver.

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     WARNING: The IMPs on the DDN may append an extra data byte
     in order to align the size of the message to a connected
     computer's preferred word size. Passage of this test may
     result in the inability to receive certain datagrams sent
     over the DDN. The IMPs should be configured to deliver data
     verbatim as implied by section 8.2.2.1.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 106".

Test 107 total length exceeds actual length of IP datagram

     -Can the IUT detect a bad total length?
     -Action: Send a datagram from the IP Tester to the IP
     Implementation Under Test whose sole defect is a total
     length that indicates that the IP datagram is vastly longer
     than it actually is in an attempt to trigger a memory
     management error or corrupt an implementation's data space.
     Unless informed otherwise, the lab should consider this a
     section 9.4.6.2.7 error condition. The IUT may send an ICMP
     Parameter Problem message to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=00107". The string "ident = 107" should
     not appear in the display of the response datagram because
     this would indicate that the datagram was passed by the IUT
     to its Remote Driver.

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 107".

Test 108 datagram length less than minimum and not multiple of 4

     -Can the IUT handle a truncated datagram?.

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test that is less than the minimum
     legal length in an attempt to trigger a memory management
     error or corrupt an implementation's data space. This is a
     section 9.4.6.2.7 error condition. Because the checksum has
     not been adjusted to be correct on the TRUNCATED header, the
     checksum is incorrect. The IUT must discard this datagram
     without notice.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 109 runt datagram with correct checksum

     -Can the IUT handle a runt datagram?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test that is less than the minimum
     legal length in an attempt to trigger a memory management
     error or corrupt an implementation's data space. This is a
     section 9.4.6.2.7 error condition. Because the checksum has
     been adjusted to be correct on the TRUNCATED header, the IUT
     may send an ICMP Parameter Problem message to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display should contain the string "ICMP
     PARAMETER PROBLEM ID=00109".

     Success: An ICMP Parameter Problem message displayed by the
     IP Tester. The total lack of an IP Tester response datagram
     display is also an acceptable response.

     Failure: A failure to pass Test 111.

Test 110 datagram length less than minimum and multiple of 4

     -Can the IUT handle a truncated datagram?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test that is less than the minimum
     legal length in an attempt to trigger a memory management
     error or corrupt an implementation's data space. This is a
     section 9.4.6.2.7 error condition. Because the checksum has
     not been adjusted on the TRUNCATED header, the checksum is
     incorrect. The IUT must discard this datagram without
     notice.

     -Verification: The IP Tester should not display a response
     datagram.

     Don't take the response to the next test as the response to
     this test. The tests follow back-to-back in rapid succession
     to give an indication that the IUT is actually being tested.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 111 legal datagram

     -Can the IUT handle a legal datagram?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test that is perfectly legal. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should parse the Remote Driver
     commands in the data field and request the IUT to send the
     reply datagram required by the Remote Driver Specification
     to the IP Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 111 data" in its 16-byte data
     field.
     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

     NOTICE: The failure of this test usually implies that one of
     the previous tests has caused the IUT to enter an infinite
     loop or crash.

Scenario File HdrChksumTest:  "IP Header Checksum Test" datagrams

800       header checksum one short

801       header checksum correct

802       header checksum are too large

803       header checksum one short with option

804       header checksum correct with option

805       header checksum one too large with option

-----------------------------------


Test 800 header checksum one less than it should be

     -Can the IUT detect a bad checksum?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test whose sole defect is a header
     checksum that is one less than it should be. The IUT must
     discard this datagram without notice.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 801 datagram with correct checksum

     -Can the IUT handle a datagram with good checksum?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test that is perfectly legal. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should parse the Remote Driver
     command in the data field and request the IUT to send the
     reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 801" in its 12-byte data field.
     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 802 header checksum one more than it should be

     -Can the IUT detect a bad checksum?

     -Action: Send a datagram from the IP Tester to the IP
     Implementation Under Test whose sole defect is a header
     checksum that is one more than it should be. The IUT must
     discard this datagram without notice.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 803 header checksum one less than it should be plus option

     -Can the IUT detect a bad checksum?

     -Action:  Send a datagram containing an option from the IP
     Tester to the IP Implementation Under Test whose sole defect
     is a header checksum that is one less than it should be. The
     IUT must discard this datagram without notice.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 804 datagram with correct checksum plus option

     -Can the IUT handle a datagram with good checksum?

     -Action:  Send a datagram containing an option from the IP
     Tester to the IP Implementation Under Test that is perfectly
     legal. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should parse the
     Remote Driver command in the data field and request the IUT
     to send the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 804" in its 12-byte data field.
     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 805 header checksum one more than it should be plus option

     -Can the IUT detect a bad checksum?

     -Action:  Send a datagram containing an option from the IP
     Tester to the IP Implementation Under Test whose sole defect
     is a header checksum that is one more than it should be. The
     IUT must discard this datagram without notice.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Scenario File ICMPReasTest:  "ICMP Reassembly Tests"

2970      ICMP Echo Request message in fragments

2971      ICMP Echo Request message fragmented in reverse order

2972      fragmented ICMP Echo Request message and bogus
fragments

2973      fragmented ICMP Echo Request message with bad fragment

2974      normal datagram

-----------------------------------

Test 2970 ICMP Echo Request message in fragments

     -Can the IUT reassemble an ICMP message?

     -Action:  Send a fragmented ICMP Echo Request message to the
     IP Implementation Under Test. The IUT should reassemble the
     fragments and send an ICMP Echo Reply message to the IP
     Tester.

     -Verification: The IP Tester response datagram display
     should include the string "ICMP ECHO REPLY id=00003". It
     should also contain the string "TL00061" to indicate that
     its total length is 61 bytes.

     Success: An IP Tester ICMP Echo Reply datagram display.
     Failure: Any response other than the display of the
     requested ICMP Echo Reply message.

Test 2971 ICMP Echo Request message fragmented in reverse order

     -Can the IUT reassemble an ICMP message fragmented in
     reverse order?

     -Action:  Send an ICMP Echo Request message fragmented in
     reverse order to the IP Implementation Under Test. The IUT
     should reassemble the fragments and send an ICMP Echo Reply
     message to the IP Tester.

     -Verification: The IP Tester response datagram display
     should include the string "ICMP ECHO REPLY id=00004". It
     should also contain the string "TLOO06l" to indicate that
     its total length is 61 bytes.

     Success: An IP Tester ICMP Echo Reply datagram display.

     Failure: Any response other than the display of the
     requested ICMP Echo Reply message.

Test 2972 fragmented ICMP Echo Request message and bogus
fragments

     -Can the IUT reject bogus fragments?

     -Action:  Send a fragmented ICMP Echo Request message and
     bogus fragments to the IP Implementation Under Test. The
     first bogus fragment has an incorrect version number which
     should be discarded by the IUT. The second bogus fragment
     has a time to live of one so it should be discarded by the
     IUT. The third bogus fragment has an incorrect checksum and
     should be discarded by the IUT. Each bogus fragment should
     be discarded without notice because each is an ICMP
     fragment. The IUT should reassemble the good fragments and
     send an ICMP Echo Reply message to the IP Tester.

     -Verification: The IP Tester response datagram display
     should include the string "ICMP ECHO REPLY id=00005". It
     should also contain the string "TLOO06l" to indicate that
     its total length is 61 bytes.

     Success: An IP Tester ICMP Echo Reply datagram display.

     Failure: Any response other than the display of the
     requested ICMP Echo Reply message.

Test 2973 fragmented ICMP Echo Request message with bad fragment

     -Can the IUT discard ICMP fragment with bad time to live?
     -Action: Send a fragmented ICMP Echo Request message to the
     IP Implementation Under Test where one of the fragments has
     a time to live of one. The bad fragment should be discarded
     without notice and the other fragments should be discarded
     without notice when the reassembly times out.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2974 normal datagram

     -Can the IUT still handle a normal datagram?

     -Action:  Send a datagram from the IP Tester to the IP
     Implementation Under Test that is perfectly legal. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should parse the Remote Driver
     commands in the data field and request the IUT to send the
     reply datagram required by the Remote Driver Specification
     to the IP Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2974" in its 13-byte data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

     NOTICE: The failure of this test usually implies that one of
     the previous tests has caused the IUT to enter an infinite
     loop or crash.

Scenario File ICMPRedrctTest: "ICMP Redirection Tests"

2950      host redirection primer datagram

2951      ICMP host redirect to IP Tester

2952      positive test of ICMP host redirect

2953      ICMP host and type of service redirect to dead gateway

2954      negative test of ICMP host and type of service redirect

2955      host + host and type of service redirect independence

2956      ICMP host redirect to dead gateway
2957      ICMP host and type of service redirect to IP Tester

2958      negative test of ICMP host redirect

2959      positive test of ICMP host and type of service redirect

2960      network redirection primer datagram

2961      ICMP network redirect to IP Tester

2962      positive test of ICMP network redirect

2963      network and type of service redirect to dead gateway

2964      negative test of network and type of service redirect

2965      net + net and type of service redirect independence

2966      ICMP network redirect to dead gateway

2967      ICMP network and type of service redirect to IP Tester

2968      negative test of ICMP network redirect

2969      positive test of network and type of service redirect

-----------------------------------

Test 2950 ICMP host redirection primer datagram

     -Datagram to prepare an implementation for host redirection.

     RFC792 pages 12-13 state that an ICMP redirect message is
     sent in response to a datagram. The implementation is asked
     to send a datagram to provide cause.

     -Action:  Send an ordinary datagram from the IP Tester to
     the IP Implementation Under Test that is perfectly legal.
     This datagram should be passed by the IUT to its Remote
     Driver. The IUT's Remote Driver should parse the Remote
     Driver command in the data field and request the IUT to send
     the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2950" in its 13-byte data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Test 2951 ICMP host redirection

     -Can the IUT redirect a datagram for a host?

     -Action:  An ICMP Host Redirect message is sent to the IUT
     by the IP Tester. The message is based on the datagram that
     the IUT is required to send in Test 2950. The ICMP Host
     Redirect message instructs the IUT to update its routing
     table(s) to send datagrams to intended for "host X" to the
     IP Tester. The IUT is ready to be tested to see if it
     handles the message.

     -Verification: The IP Tester should not display a response
     datagram. Actual verification of host redirection occurs in
     Tests 2952 and 2955.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2952 ICMP host redirection verification

     -Can the IUT redirect a datagram for a host?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the Remote Driver
     Specification to the IP Tester since the IUT was told to
     redirect datagrams for "host X" in Test 2951.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2952 dest = 1711341568" in its
     31-byte data field.

     Success: Display of reply datagram.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 2953 ICMP host and type of service redirection

     -Can the IUT redirect a datagram for a host based on its
     type of service?

     -Action:  An ICMP Host and Type of Service Redirect message
     is sent to the IUT by the IP Tester. The message is based on
     the datagram that the IUT is required to send in Test 2950.
     The message contains a precedence of 1 in the "copy" of the
     "original" datagram's header field. The ICMP Host and Type
     of Service Redirect message instructs the IUT to update its
     routing table(s) to send datagrams with precedence 1
     intended for "host X" to the "dead gateway," an unused port
     on one of the EDN's IMPs. The IUT is ready to be tested to
     see if it handles the message.

     -Verification: The IP Tester should not display a response
     datagram. Actual verification of host and type of service
     redirection occurs in Test 2954.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2954 ICMP host and type of service redirection verification

     -Can the IUT redirect a datagram for a host based on type of
     service?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the Remote Driver
     Specification to the IUT because the IUT was told to
     redirect datagrams with precedence of 1 for "host X" in Test
     2953. The IUT should send the reply datagram to the "dead
     gateway." The IMP should discard it without notice on the IP
     level.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2955 ICMP host redirection additional verification

     -Can the IUT remember host redirection after host and type
     of service redirection?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver shouId request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester because the IUT was
     told to redirect datagrams for "host X" in Test 2951.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2955 dest = 1711341568" in its
     31-byte data field.

     Success: Display of reply datagram.
     Failure: Any response other than the display of the
     requested reply datagram.

Test 2956 ICMP host redirection

     -Can the IUT redirect a datagram for a host?

     -Action:  An ICMP Host Redirect message is sent to the IUT
     by the IP Tester. The message is based on the datagram that
     the IUT is required to send in Test 2950. The ICMP Host
     Redirect message instructs the IUT to update its routing
     table(s) to send datagrams to intended for "host X" to the
     "dead gateway."

     -Verification: The IP Tester should not display a response
     datagram. Actual verification of host redirection occurs in
     Test 2958.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2957 ICMP host and type of service redirection

     -Can the IUT redirect a datagram for a host based on its
     type of service?

     -Action:  An ICMP Host and Type of Service Redirect message
     is sent to the IUT by the IP Tester. The message is based on
     the datagram that the IUT is required to send in Test 2950.
     The message contains a precedence of 1 in the "copy" of the
     "original" datagram's header field. The ICMP Host and Type
     of Service Redirect message instructs the IUT to update its
     routing table(s) to send datagrams with precedence 1
     intended for "host X" to the IP Tester.

     -Verification: The IP Tester should not display a response
     datagram. Actual verification of host and type of service
     redirection occurs in Test 2959.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2958 ICMP host redirection verification

     -Can the IUT redirect a datagram for a host?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the Remote Driver
     Specification to the IUT because the IUT was told to
     redirect datagrams for "host X" in Test 2956. The IUT should
     send the reply datagram to the "dead gateway." The IMP
     should discard it without notice on the IP level.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2959 ICMP host and type of service redirection verification

     -Can the IUT redirect a datagram for a host based on type of
     service?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the Remote Driver
     Specification to the IUT because the IUT was told to
     redirect datagrams with precedence of 1 for "host X" in Test
     2957. The IUT should send the reply datagram to the IP
     Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2959 dest = 1711341568" in its
     31-byte data field.

     Success: Display of reply datagram.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 2960 ICMP network redirection primer datagram

     -Datagram to prepare an implementation for network
     redirection.

     RFC792 pages 12-13 state that an ICMP redirect message is
     sent in response to a datagram. The implementation is asked
     to send a datagram to provide cause.

     -Action:  Send an ordinary datagram from the IP Tester to
     the IP Implementation Under Test that is perfectly legal.
     This datagram should be passed by the IUT to its Remote
     Driver. The IUT's Remote Driver should parse the Remote
     Driver command in the data field and request the IUT to send
     the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.
     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2960" in its 13-byte data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 2961 ICMP network redirection

     -Can the IUT redirect a datagram for a network?

     -Action: An ICMP Network Redirect message is sent to the IUT
     by the IP Tester. The message is based on the datagram that
     the IUT is required to send in Test 2960. The ICMP Network
     Redirect message instructs the IUT to update its routing
     table(s) to send datagrams to intended for "network Y" to
     the IP Tester. The IUT is ready to be tested to see if it
     handles the message.

     -Verification: The IP Tester should not display a response
     datagram. Actual verification of network redirection occurs
     in Tests 2962 and 2965.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2962 ICMP network redirection verification

     -Can the IUT redirect a datagram for a network?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the Remote Driver
     Specification to the IP Tester because the IUT was told to
     redirect datagrams for "network Y" in Test 2961.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2962 dest = 1728118784" in its
     31-byte data field.

     Success: Display of reply datagram.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 2963 ICMP network and type of service redirection

     -Can the IUT redirect a datagram for a network based on its
     type of service?
     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2965 dest = 1728118784" in its
     31-byte data field.

     Success: Display of reply datagram.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 2966 ICMP network redirection

     -Can the IUT redirect a datagram for a network?

     -Action:  An ICMP Network Redirect message is sent to the
     IUT by the IP Tester. The message is based on the datagram
     that the IUT is required to send in Test 2960. The ICMP
     Network Redirect message instructs the IUT to update its
     routing table(s) to send datagrams to intended for "network
     Y" to the"dead gateway."

     -Verification: The IP Tester should not display a response
     datagram. Actual verification of network redirection occurs
     in Test 2968.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.-

Test 2967 ICMP network and type of service redirection

     -Can the IUT redirect a datagram for a network based on its
     type of service?

     -Action:  An ICMP Network and Type of Service Redirect
     message is sent to the IUT by the IP Tester. The message is
     based on the datagram that the IUT is required to send in
     Test 2960. The message contains a precedence of 1 in the
     "copy" of the "original" datagram's header field. The ICMP
     Network and Type of Service Redirect message instructs the
     IUT to update its routing table(s) to send datagrams with
     precedence 1 intended for "network Y" to the IP Tester.

     -Verification: The IP Tester should not display a response
     datagram. Actual verification of network and type of service
     redirection occurs in Test 2969.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2968 ICMP network redirection verification
     -Can the IUT redirect a datagram for a network?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the Remote Driver
     Specification to the IUT because the IUT was told to
     redirect datagrams for "network Y" in Test 2966. The IUT
     should send the reply datagram to the "dead gateway." The
     IMP should discard it without notice on the IP level.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2969 network and type of service redirection verification

     -Can the IUT redirect a datagram for a network based on type
     of service?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the Remote Driver
     Specification to the IUT because the IUT was told to
     redirect datagrams with precedence of 1 for "network Y" in
     Test 2967. The IUT should send the reply datagram to the IP
     Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2969 dest = 1728118784" in its
     31-byte data field.

     Success: Display of reply datagram.

     Failure: Any response other than the display of the
     requested reply datagram.

Scenario File ICMPSrcQueTest: "ICMP Source Quench Test" 2930-2934
ICMP Source Quench




Test 2930 ICMP Source Quench primer datagram

     -Datagram to prepare IUT to be source quenched.

     Section 9.4.6.3.1 states that an ICMP Source Quench message
     indicates that a datagram has been discarded. This implies
     that a datagram was sent by the implementation. Protocol
     implementations for a military environment may not allow a
     random message to impede their operation for even a short
     time without cause. The implementation is asked send a
     datagram to provide cause.

     It is unlikely that an implementation will check unless
     required to by contract.

     -Action:  Send an ordinary datagram from the IP Tester to
     the IP Implementation Under Test that is perfectly legal.
     This datagram should be passed by the IUT to its Remote
     Driver. The IUT's Remote Driver should parse the Remote
     Driver command in the data field and request the IUT to send
     the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2930 " in its 13-byte data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 2931 first ICMP Source Quench

     -Can the IUT shut up or slow down when source quenched?

     -Action:  An ICMP Source Quench message is sent to the IUT
     by the IP Tester. The message is based on the datagram that
     the IUT is required to send in Test 2930. The ICMP Source
     Quench message instructs the IUT or its upper level protocol
     (its Remote Driver) to reduce the rate at which it is
     sending datagrams. Because the IP Remote Driver is not
     required by the IP Remote Driver Specification to process an
     ICMP Source Quench, the IUT is ready to be tested to see if
     it handles the message.

     Eight datagrams are sent to the IUT by the IP Tester. These
     should by accepted by the IUT and passed to its Remote
     Driver. The Remote Driver should request the IUT to send a
     reply datagram for each one. The IUT should eventually send
     the eight reply datagrams to the IP Tester.

     -Verification: The IP Tester will display the eight reply
     datagrams. Each must contain "ident = 780 " in its 12-byte
     data field. Because the script asynchronously instructs the
     IP Test Controller to write "tick" to the log file every
     second, the displays may be a bit messy. This is normal and
     desirable because it provides the means to determine how
     much of a rate reduction the IUT is providing.

     There is no official performance criterion.
     Success: Display of each of the eight reply datagrams
     requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagrams.

     WARNING: The IUT may forget that it sent the datagram in
     Test 2930, causing the Source Quench to be ignored. This can
     be counteracted by adjusting the wait time (wait 10) for
     Test 2930 to a smaller value. This problem is unlikely.

Test 2932 second ICMP Source Quench

     -Can the IUT further reduce its rate of transmission?

     -Action:  An ICMP Source Quench message is sent to the IUT
     by the IP Tester. The message is based on the datagram that
     the IUT is required to send in Test 2930.

     Eight datagrams are sent to the IUT by the IP Tester. These
     should by accepted by the IUT and passed to its Remote
     Driver. The Remote Driver should request the IUT to send a
     reply datagram for each one. The IUT should eventually send
     the eight reply datagrams to the IP Tester.

     -Verification: The IP Tester will display the eight reply
     datagrams. Each must contain "ident = 780 " in its 12-byte
     data field.

     There is no official performance criterio~. However, the
     Internet Control Message Protocol Protocol Specification
     TM-WD-7411/300/01 states "the source host should cut back
     the rate at which it is sending traffic to the specified
     destination." This can be confirmed by fewer characters (on
     average) between "ticks." MIL-STD-1777 only requires that
     "the ULP should be informed so traffic can be reduced."
     Therefore, the lack of FURTHER reduction isn't non-
     conformant. However, all known ICMP standards require
     reduction.

     Success: Display of each of the eight reply datagrams
     requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagrams.

Test 2933 third ICMP Source Quench

     -Can the IUT further reduce its rate of transmission?

     -Action:  An ICMP Source Quench message is sent to the IUT
     by the IP Tester. The message is based on the datagram that
     the IUT is required to send in Test 2930.

     Eight datagrams are sent to the IUT by the IP Tester. These
     should by accepted by the IUT and passed to its Remote
     Driver. The Remote Driver should request the IUT to send a
     reply datagram for each one. The IUT should eventually send
     the eight reply datagrams to the IP Tester.

     -Verification: The IP Tester will display the eight reply
     datagrams. Each must contain "ident = 780 " in its 12-byte
     data field.

     There is no official performance criterion. However, the
     Internet Control Message Protocol Protocol Specification
     TM-WD-7411/300/01 states "the source host should cut back
     the rate at which it is sending traffic to the specified
     destination." This can be confirmed by fewer characters (on
     average) between "ticks." MIL-STD-1777 only requires that
     "the ULP should be informed so traffic can be reduced."
     Therefore, the lack of FURTHER reduction isn't non-
     conformant. However, all known ICMP standards require
     reduction.

     Success: Display of each of the eight reply datagrams
     requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagrams.

Test 2934 fourth ICMP Source Quench

     -Can the IUT further reduce its rate of transmission?

     -Action:  An ICMP Source Quench message is sent to the IUT
     by the IP Tester. The message is based on the datagram that
     the IUT is required to send in Test 2930.

     Eight datagrams are sent to the IUT by the IP Tester. These
     should by accepted by the IUT and passed to its Remote
     Driver. The Remote Driver should request the IUT to send a
     reply datagram for each one. The IUT should eventually send
     the eight reply datagrams to the IP Tester.

     -Verification: The IP Tester will display the eight reply
     datagrams. Each must contain "ident = 780 " in its 12-byte
     data field.

     There is no official performance criterion. However, the
     Internet Control Message Protocol Protocol Specification
     TM-WD-7411/300/01 states "the source host should cut back
     the rate at which it is sending traffic to the specified
     destination.' This can be confirmed by fewer characters (on
     average) between "ticks." MIL-STD-1777 only requires that
     "the ULP should be informed so traffic can be reduced.'
     Therefore, the lack of FURTHER reduction isn't non-
     conformant.   However, all known ICMP standards require
     reduction.
     Success: Display of each of the eight reply datagrams
     requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagrams.

     NOTICE: The IUT could conceivably send an ICMP Source Quench
     message, whose display will contain the string "unexpected
     ICMP error type=4". MIL-STD-1777 does not indicate how this
     is to be interpreted. The laboratory will not issue a report
     on the IUT until the specification is amended. IUTs having
     difficulties will have to wait (2+ years ?) for
     certification.

Scenario File ICMPartlTest:  "Miscellaneous ICMP Tests"

2900      normal datagram

2901      ICMP echo request with bad IP header checksum

2902      ICMP echo request with bad ICMP header checksum

2903      valid ICMP echo request

2904      ICMP Parameter Problem

2905      ICMP time to live exceeded

2906      ICMP reassembly timeout

2907      ICMP unreachable network

2908      ICMP unreachable host

2909      ICMP unreachable protocol

2910      ICMP unreachable port

2911      ICMP fragmentation needed and DF set

2912      ICMP source route failed

2913      normal datagram

-----------------------------------


Test 2900 ICMP message primer datagram

     -Datagram to prepare an implementation for ICMP messages.

     -Action:  Send an ordinary datagram from the IP Tester to
     the IP Implementation Under Test that is perfectly legal.
     This datagram should be passed by the IUT to its Remote
     Driver. The IUT's Remote Driver should parse the Remote
     Driver command in the data field and request the IUT to send
     the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2900 " in its 13-byte data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 2901 ICMP Echo Request message with bad IP header chec

     -Can the IUT detect a bad IP header checksum in an ICMP
     message?

     -Action:  Send an ICMP Echo Request message to the IP
     Implementation Under Test whose sole defect is a bad IP
     header checksum. The IUT must discard this datagram without
     notice.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2902 ICMP Echo Request message with bad ICMP checksum

     -Can the IUT detect a bad ICMP checksum?

     -Action:  Send an ICMP Echo Request message to the IP
     Implementation Under Test whose sole defect is a bad ICMP
     checksum. The IUT should discard this datagram without
     notice.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2903 ICMP Echo Request message with valid checksums

     -Can the IUT reply to an ICMP Echo Request message?

     -Action:  Send a legal ICMP Echo Request message to the IP
     Implementation Under Test. The IUT should send an ICMP Echo
     Reply message to the IP Tester.
     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2907 ICMP Unreachable Network message

     -Can the IUT handle an ICMP Unreachable Network message?

     -Action:  Send an ICMP Unreachable Network message to the IP
     -Implementation Under Test. All further action is
     implementation dependent according to section 9.4.6.3.1. The
     most likely action is to log the message.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2908 ICMP Unreachable Host message

     -Can the IUT deal with an ICMP Unreachable Host message?

     -Action:  Send an ICMP Unreachable Host message to the IP
     Implementation Under Test. All further action is
     implementation dependent according to section 9.4.6.3.1. The
     most likely action is to log the message.

     -Verification: The IP-Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2909 ICMP Unreachable Protocol message

     -Can the IUT handle an ICMP Unreachable Protocol message?

     -Action:  Send an ICMP Unreachable Protocol message to the
     IP Implementation Under Test. All further action is
     implementation dependent according to section 9.4.6.3.1. The
     most likely action is to log the message.

     -Verification: The IP Tester should not display a response
     datagram.
     -Verification: The IP Tester response datagram display
     should include the string "ICMP ECHO REPLY id=00002". It
     should also contain the string "TL00046"' to indicate that
     its total length is 46 bytes.

     Success: An IP Tester ICMP Echo Reply datagram display.

     Failure: Any response other than the display of the
     requested ICMP Echo Reply message.

Test 2904 ICMP Parameter Problem message

     -Can the IUT deal with an ICMP Parameter Problem message?

     -Action:  Send an ICMP Parameter Problem message to the IP
     Implementation Under Test. All further action is
     implementation dependent according to section 9.4.6.3.1. The
     most likely action is to log the message.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2905 ICMP Time to Live Exceeded In Transit message

     -Can the IUT deal with an ICMP Time Exceeded message?

     -Action:  Send an ICMP Time Exceeded in Transit message to
     the IP Implementation Under Test. All further action is
     implementation dependent according to section 9.4.6.3.1. The
     most likely action is to log the message.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2906 ICMP Time to Live Exceeded During Reassembly message

     -Can the IUT deal with an ICMP Time Exceeded message?

     -Action:  Send an ICMP Time Exceeded During Reassembly
     message to the IP Implementation Under Test. All further
     action is implementation dependent according to section
     9.4.6.3.1. The most likely action is to log the message.
     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2910 ICMP Unreachable Port message

     -Can the IUT deal with an ICMP Unreachable Port message?

     -Action:  Send an ICMP Unreachable Port message to the IP
     Implementation Under Test. All further action is
     implementation dependent according to section 9.4.6.3.1. The
     most likely action is to log the message.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2911 ICMP Fragmentation Needed and DF Set message

     -Can the IUT deal with an ICMP Fragmentation Needed and DF
     Set message?

     -Action:  Send an ICMP Fragmentation Needed and DF Set-
     message to the IP Implementation Under Test. All further
     action is implementation dependent according to section
     9.4.6.3.1. The most likely action is to log the message.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.

     Failure: An IP Tester response datagram display of any kind.

Test 2912 ICMP Source Route Failed message

     -Can the IUT deal with an ICMP Source Route Failed message?

     -Action:  Send an ICMP Source Route Failed message to the IP
     Implementation Under Test. All further action is
     implementation dependent according to section 9.4.6.3.1. The
     most likely action is to log the message.

     -Verification: The IP Tester should not display a response
     datagram.

     Success: The total lack of an IP Tester response datagram
     display is the only acceptable response.
     Failure: An IP Tester response datagram display of any kind.

Test 2913 ICMP message robustness check

     -Did the IUT handle bogus ICMP messages without crashing?

     -Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the Remote Driver
     Specification to the IP Tester.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 2913 " in its 13-byte data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram. The actual failure probably
     occurred during one of the previous tests.

Scenario File IdentTest: "Identification Field Test' datagrams

0         send and receive fields 0

65535     send and receive fields 65535

3690      send and receive fields 43690

21845     send and receive fields 21845

65535     send field 65535 and receive field 0

0         send field 0 and receive field 65535

21845     send field 21845 and receive field 43690

43690     send field 43690 and receive field 21845

-----------------------------------

     Test 0 send and receive identification fields of 0

     -Can the IUT receive and send a datagram with an ID of 0?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an identification field of 0. This datagram should
     be passed by the IUT to its Remote Driver. The IUT's Remote
     Driver should request the IUT to send the reply datagram
     required by the IP Remote Driver Specification to the IP
     Tester. The reply datagram ought to have an identification
     field of 0.
     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 0 " in its 10-byte data field. In
     addition, the display ought to contain the string "ID00000",
     but any value may be used instead of "00000."

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 65535 send and receive identification fields of 65535

     -Can the IUT receive and send a datagram with an ID of
     65535?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an identification field of 65535. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The reply datagram ought to have an
     identification field of 65535.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 65535" in its 14-byte data field.
     In addition, the display ought to contain the string
     "ID65535", but any value may be used instead of "65535."

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 43690 send and receive identification fields of 43690

     -Can the IUT receive and send a datagram with an ID of
     43690?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an identification field of 43690 (odd-numbered
     bits set). This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester. The reply datagram
     ought to have an identification field of 43690.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 43690' in its 14-byte data field.
     In addition, the display ought to contain the string
     "ID43690', but any value may be used instead of "43690.'

     Success: Display of reply datagram requested to be sent.
     Failure: Any response other than the display of the
     requested reply datagram.

Test 21845 send and receive indentification fields of 21845

     -Can the IUT receive and send a datagram with an ID of
     21845?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an identification field of 21845 (even-numbered
     bits set). This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester. The reply datagram
     ought to have an identification field of 21845.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 21845 " in its 14-byte data
     field. In addition, the display ought to contain the string
     "ID21845', but any value may be used instead of "21845.'

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 65535 send field of 65535 and receive field of 0

     -Can the IUT accept an identification field from its upper
     level protocol?

     This test prevents IUTs from recording the identification
     field of the datagram passed to the Remote Driver and using
     it in the reply datagram sent by the Remote Driver to gain a
     better report.

     -Action:  Send a datagram to the IP Implementation Under
     Test with an identification field of 0. This datagram should
     be passed by the IUT to its Remote Driver. The IUT's Remote
     Driver should request the IUT to send the reply datagram
     required by the IP Remote Driver Specification to the IP
     Tester. The reply datagram ought to have an identification
     field of 65535.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 65535 " in its 14-byte data
     field. In addition, the display ought to contain the string
     "ID65535", but any value may be used instead of "65535."

     Success: Display of reply datagram requested to be sent.
     Failure: Any response other than the display of the
     requested reply datagram.

Test 0 send field of 0 and receive field of 65535

     -Can the IUT accept an identification field from its upper
     level protocol

     -Action:  Send a datagram to the IP Implementation Under
     Test with an identification field of 65535. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The reply datagram ought to have an
     identification field of 0.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 0 " in its 10-byte data field. In
     addition, the display ought to contain the string "ID00000",
     but any value may be used instead of "00000."

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 21845 send field of 21845 and receive field of 43690

     -Can the IUT accept an identification field from its upper
     level protocol

     -Action:  Send a datagram to the IP Implementation Under
     Test with an identification field of 43690. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The reply datagram ought have an
     identification field of 21845.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 21845 " in its 14-byte data
     field. In addition, the display ought to contain the string
     "ID21845", but any value may be used instead of "21845."

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 43690 send field of 43690 and receive field of 21845

     -Can the IUT accept an identification field from its upper
     level protocol ?
     -Action:  Send a datagram to the IP Implementation Under
     Test with an identification field of 21845. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The reply datagram ought to have an
     identification field of 43690.

     -Verification: The IP Tester will display the reply datagram
     that must contain "ident = 43690 " in its 14-byte data
     field. In addition, the display ought to contain the string
     "ID43690", but any value may be used instead of "43690."

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Scenario File NoOpLenBotTest: "Bottom-up Missing Option Length"
datagrams

2200      security

2201      stream identification

2202      record route

2203      timestamp

2204      loose source

2205      strict source


-----------------------------------

Test 2200 security option sans option length

     -Can the IUT interpret an incomplete security option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with a 4-byte option field. The first three bytes are
     no operation options (to permit the truncation of the
     following "option"). The last byte represents the option
     type byte of a security option. Normally, the option type is
     followed by the option length. The IUT is required to figure
     out the proper action in accordance with section 9.1.
     Because there is not very much to "interpret," the IUT
     probably should send an ICMP Parameter Problem message to
     the IP Tester and discard the datagram.
     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02200". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2200 " in its 13-byte data field.

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2200", or nothing.

     Failure: A failure to pass the next test performed after
     this test that requires a positive response from the IUT
     (Test 4200).

Test 2201 stream identification option sans option length

     -Can the IUT interpret an incomplete stream ID option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with a 4-byte option field. The first three bytes are
     no operation options (to permit the truncation of the
     following "option"). The last byte represents the option
     type byte of a stream ID option. Normally, the option type
     is followed by the option length. The IUT is required to
     figure out the proper action in accordance with section 9.1.
     Because there is not very much to "interpret," the IUT
     probably should send an ICMP Parameter Problem message to
     the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote-Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02201". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2201 " in its 13-byte data field.

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2201 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that requires a positive response from the IUT
     (Test 4200).

Test 2202 record route option sans option length
     -Can the IUT interpret an incomplete record route option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with a 4-byte option field. The first three bytes are
     no operation options (to permit the truncation of the
     following "option"). The last byte represents the option
     type byte of a record route option. Normally, the option
     type is followed by the option length. The IUT is required
     to figure out the proper action in accordance with section
     9.1. Because there is not very much to "interpret," the IUT
     probably should send an ICMP Parameter Problem message to
     the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02202". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2202" in its 13-byte data field.

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2202 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that requires a positive response from the IUT
     (Test 4200).

Test 2203 timestamp option sans option length

     -Can the IUT interpret an incomplete timestamp option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with a 4-byte option field. The first three bytes are
     no operation options (to permit the truncation of the
     following "option.") The last byte represents the option
     type byte of a timestamp option. Normally, the option type
     is followed by the option length. The IUT is required to
     figure out the proper action in accordance with section 9.1.
     Because there is not very much to "interpret," the IUT
     probably should send an ICMP Parameter Problem message to
     the IP Tester and discard the datagram.

     It is possible that the IUT' will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification: If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02203". However, if the IUT chooses to
     pass the datagram to its Remote Driver the reply datagram
     must contain "ident = 2203 " in its 13-byte data field.

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2203 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that requires a positive response from the IUT
     (Test 4200).

Test 2204 loose source and record route option sans option length

     -Can the IUT interpret an incomplete loose source and record
     route option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with a 4-byte option field. The first three bytes are
     no operation options (to permit the elimination of the
     option length). The last byte represents the option type
     byte of a loose source and record route option. Normally,
     the option type is followed by the option length. The IUT is
     required to figure out the proper action in accordance with
     section 9.1. Because there is not very much to "interpret,"
     the IUT probably should send an ICMP Parameter Problem
     message to the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02204". However, if the IUT chooses to
     pass the datagram to Its Remote Driver, the reply datagram
     must contain "ident = 2204 " in its 13-byte data field.

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2204", or nothing.

     Failure: A failure to pass the next test performed after
     this test that requires a positive response from the IUT
     (Test 4200).

Test 2205 strict source and record route option sans option
length

     -Can the IUT interpret an incomplete strict source and
     record route option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with a 4-byte option field. The first three bytes are
     no operation options (to permit the truncation of the
     following "option"). The last byte represents the option
     type byte of a strict source and record route option.
     Normally, the option type is followed by the option length.
     The IUT is required to figure out the proper action in
     accordance with section 9.1.  Because there is not very much
     to "interpret," the IUT probably should send an ICMP
     Parameter Problem message to the IP Tester and discard the
     datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02205". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2205 " in its 13-byte data field.

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2205 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that requires a positive response from the IUT
     (Test 4200).

Scenario File NoOpLenTopTest: "Top-down Missing Option
Length" datagrams

4200      security

4201      stream identification

4202      record route

4203      timestamp

4204      loose source

4205      strict source

-----------------------------------


Test 4200 security option sans option length

     -Can the IUT send an incomplete security option?

     -Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a 4-byte option field. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The first three bytes of the invalid option
     field that the IUT is requested to send are no operation
     options (to permit the truncation of the following
     "option").   The last byte represents the option type byte of
     a security option. The IUT is required to inform its Remote
     Driver that the request is invalid. The Remote Driver should
     then request the IUT to send an IP Remote Driver
     Specification error message to the IP Tester.

     -Verification: The IP Tester will display the error message
     datagram that must contain "ident = 4200 error" in its 18-
     byte data field. The IP Tester should also display "HL5"
     (internet header length is 5 four-octet units long) to
     indicate that the error message datagram does not contain
     the invalid option field in its IP header.

     Success: Display of error message datagram.

     Failure: Any response other than the display of the error
     message datagram.

Test 4201 stream ID option sans option length

     -Can the IUT send an incomplete stream ID option?

     -Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a 4-byte option field. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver-Specification to
     the IP Tester. The first three bytes of the invalid option
     field that the IUT is requested to send are no operation
     options (to permit the truncation of the following
     "option"). The last byte represents the option type byte of
     a stream identification option. The IUT is required to
     inform its Remote Driver that the request is invalid. The
     Remote Driver should then request the IUT to send an IP
     Remote Driver Specification error message to the IP Tester.

     -Verification: The IP Tester will display the error message
     datagram that must contain "ident = 4201 error" in its 18-
     byte data field. The IP Tester should also display "HL5"
     (internet header length is 5 four-octet units long) to
     indicate that the error message datagram does not contain
     the invalid option field in its IP header.

     Success: Display of error message datagram.

     Failure: Any response other than the display of the error
     message datagram.

Test 4202 record route option sans option length

     -Can the IUT send an incomplete record route option?
     -Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a 4-byte option field. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The first three bytes of the invalid option
     field that the IUT is requested to send are no operation
     options (to permit the truncation of the following
     "option").  The last byte represents the option type byte of
     a record route option. The IUT is required to inform its
     Remote Driver that the request is invalid. The Remote Driver
     should then request the IUT to send an IP Remote Driver
     Specification error message to the IP Tester.

     -Verification: The IP Tester will display the error message
     datagram that must contain "ident = 4202 error" in its 18-
     byte data field. The IP Tester should also display "HL5"
     (internet header length is 5 four-octet units long) to
     indicate that the error message datagram does not contain
     the invalid option field in its IP header.

     Success: Display of error message datagram.

     Failure: Any reaponse other than the display of the error
     message datagram.

Test 4203 timestamp option sans option length

     -Can the IUT send an incomplete record route option?

     -Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a 4-byte option fieId. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The first three bytes of the invalid option
     field that the IUT is requested to send are no operation
     options (to permit the truncation of the following
     "option").  The last byte represents the option type byte of
     a timestamp option. The IUT is required to inform its Remote
     Driver that the request is invalid. The Remote Driver should
     then request the IUT to send an IP Remote Driver
     Specification error message to the IP Tester.

     -Verification: The IP Tester will display the error message
     datagram that must contain "ident = 4203 error" in its 18-
     byte data field. The IP Tester should also display "HL5"
     (internet header length is 5 four-octet units long) to
     indicate that the error message datagram does not contain
     the invalid option field in its IP header.

     Success: Display of error message datagram.
     Failure: Any response other than the display of the error
     message datagram.

Test 4204 loose source and record route option sans option length

     -Can the IUT send an incomplete loose source and record
     route option?

     -Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a 4-byte option field. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The first three bytes of the invalid option
     field that the IUT is requested to send are no operation
     options (to permit the truncation of the following
     "option"). The last byte represents the option type byte of
     a loose source and record route option. The IUT is required
     to inform its Remote Driver that the request is invalid. The
     Remote Driver should then request the IUT to send an IP
     Remote Driver Specification error message to the IP Tester.

     -Verification: The IP Tester will display the error message
     datagram that must contain "ident = 4204 error" in its 18-
     byte data field. The IP Tester should also display "HL5"
     (internet header length is 5 four-octet units long) to
     indicate that the error message datagram does not contain
     the invalid option field in its IP header.

     Success: Display of error message datagram.

     Failure: Any response other than the display of the error
     message datagram.

Test 4205 strict source and record route option sans option
length

     -Can the IUT send an incomplete strict source and record
     route option?

     -Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a 4-byte option field. This datagram
     should be passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester. The first three bytes of the invalid option
     field that the IUT is requested to send are no operation
     options (to permit the truncation of the following
     "option"). The last byte represents the option type byte of
     a strict source and record route option. The IUT is required
     to inform its Remote Driver that the request is invalid. The
      Remote Driver should then request the IUT to send an IP
     Remote Driver Specification error message to the IP Tester.

      -Verification: The IP Tester will display the error message
      datagram that must contain "ident = 4205 error" in its 18-
      byte data field. The IP Tester should also display "HL5"
      (internet leader length is 5 four-octet units long) to
      indicate that the error message datagram does not contain
      the invalid option field in its IP header.

      Success: Display of error message datagram.

      Failure: Any response other than the display of the error
      message datagram.

Scenario File OddReasTest: "Oddball Reassembly Tests"

570       MF and DF both set

571       DF set and fragment offset not 0

572       enormous fragment offset

573       range of fragment offsets

574       precedence mismatch

575       security level mismatch with unclassified exception

576       security level mismatch

577       security level mismatch with classified exception

578       first compartment byte mismatch

579       second compartment byte mismatch

580       first handling byte mismatch

581       second handling byte mismatch

582       first transmission control code byte mismatch

583       second transmission control code byte mismatch

584       third transmission control code byte mismatch

585       security option present exception

-----------------------------------

Test 570  more and don't fragment flags both set

      -Can the IUT deal with contradictory framentation flags?
      -Action:  Send a datagram to the IP Implementation Under
      Test.with both the more fragment(s) and don't fragment flags
      set. There are two ways the IUT could choose to handle the
      contradictory flags.

      One method is to create a state vector and record the
      "fragment." When the state vector's timer expires, the state
      vector and "fragment" will be discarded and an ICMP
      reassembly timeout message may be sent by the IUT to the IP
      Tester. Another method envisioned is that the IUT will
      detect that both of the fragmentation flags are set. The IUT
      may then send an ICMP Parameter Problem message to the IP
      Tester. This method should be considered legal by the lab
      under section 9.4.6.2.7, unless otherwise instructed.

      -Verification:  If there is an IP Tester response datagram
      display, it should contain either "ICMP TIME EXCEEDED
      id=00570 REAS" or "ICMP PARAMETER PROBLEM id=00570". The
      response datagram display should not contain the string
      "ident" because that would indicate that the "fragment" was
      passed to the IUT's Remote Driver. The total lack of a
      response datagram is also a correct response.

      Success: An ICMP reassembly timeout message, ICMP Parameter
      Problem message, or nothing.

      Failure: A reply datagram containing "ident".

Test 571 missive with non-zero offset with don't fragment flag
set

      -Can the IUT deal with a missive with contradictory fragment
      offset and don't fragment flag fields?

      -Action:  Send a datagram to the IP Implementation Under
      Test with a non-zero fragment offset and the don't fragment
      flag set. There are two ways the IUT could choose to handle
      the contradictory fields.

      One method is to create a state vector and record the
      "fragment." When the state vector's timer expires, the state
      vector and "fragment" will be discarded and an ICMP
      reassembly timeout message may be sent by the IUT to the IP
      Tester.

      Another method envisioned is that the IUT will detect that
      fields are contradictory. The IUT may then send an ICMP
      Parameter Problem to the IP Tester. Unless instructed
      otherwise, this method should be considered legal by the lab
      under section 9.4.6.2.7.

      -Verification:  If there is an IP Tester response datagram
      display, it should contain either "ICMP TIME EXCEEDED
      id=00571 REAS" or "ICMP PARAMETER PROBLEM id=00571". The
      response datagram display should not contain the string
      "ident" because that would indicate that the "fragment" was
      passed to the IUT's Remote Driver. The total lack of a
      response datagram display is also an acceptable response.

      Success: An ICMP Parameter Problem message, ICMP reassembly
      timeout message, or nothing.

      NOTICE: The receipt of an ICMP reassembly timeout message
      (for a fragment with a non-zero offset) indicates that the
      IUT does not conform to RFC792.  It is not grounds for the
      denial of MIL-STD-1777 certification.

      Failure: A reply datagram containing "ident".

Test 572 fragment with an enormous fragment offset

      -Can the IUT deal with fragment with enormous fragment
      offset;?

      -Action:  Send a perfectly legal fragment to the IP
      Implementation Under Test with an enormous fragment offset.
      The IUT should either discard the fragment or create a state
      vector to prepare to receive additional fragments.

      If a state vector is created, its timer should expire and
      the state vector should be discarded. In addition, the IUT
      may send an ICMP reassembly timeout message to the IP
      Tester.

      -Verification:  If there is an IP Tester response datagram
      display, it should contain "ICMP TIME EXCEEDED id=00572
      REAS". It should not contain "ICMP PARAMETER PROBLEM
      id=00572" because that would indicate that the IUT
      considered the perfectly legal fragment defective.

      The total lack of a response datagram display is also an
      acceptable response.

      Success: An ICMP reassembly timeout message, or nothing.

      NOTICE: The receipt of an ICMP reassembly timeout message
      (for a fragment with a non-zero offset) indicates that the
      IUT does not conform to RFC792.  It is not grounds for the
      denial of MIL-STD-1777 certification.

      Failure: An ICMP Parameter Problem message.

Test 573 fragments spanning upper range of fragment offsets

      -Can the IUT deal with upper range of fragment offsets?

      -Action:  Send 79 perfectly legal fragments to the IP
      Implementation Under Test spanning the upper range of
      fragment offsets. For each fragment, the IUT should either
      discard the fragment or create a state vector to prepare to
      receive additional fragments.

      If a state vector is created, its timer should expire before
      the next fragment is sent to the IUT. The state vector
      should be discarded. in addition, the IUT may send an ICMP
      reassembly timeout message to the IP Tester.

      -Verification: The IP Tester display of each possible
      response datagram should contain "ICMP TIME EXCEEDED
      id=00573 REAS". No IP Tester response datagram display
      should contain "ICMP PARAMETER PROBLEM id=00573" because
      that would indicate that the IUT considered a perfectly
      legal fragment defective.

      The total lack of a response datagram display for any
      fragment is also an acceptable response for that fragment.

      Success: An ICMP reassembly timeout message, or nothing.

      NOTICE: The receipt of an ICMP reassembly timeout message
      (for a fragment with a non-zero offset) indicates that the
      IUT does not conform to RFC792. It is not grounds for the
      denial of MIL-STD-1777 certification.

      Failure: An ICMP Parameter Problem message.

Test 574 precedence mismatch

      -Can the IUT detect a reassembly precedence mismatch?

      -Action:  The IP Tester sends a fragment with precedence I
      to the IP Implementation Under Test. This should cause the
      IUT to create a state vector. The IP Tester will also send
      another fragment with precedence 0 to the IP Implementation
      Under.Test. The IUT should then send "an error datagram"
      (presumably an ICMP Parameter Problem message) to the IP
      Tester to indicate that a precedence mismatch was detected.
      The current reassembly should be discarded. This is followed
      by the three remaining fragments sent by the IP Tester to
      the IUT. These are not sufficient to reassemble a datagram,
      so the IUT should eventually discard the second reassembly.
      The IUT may send an ICMP reassembly timeout message to the
      IP Tester.

      -Verification: The IP Tester display ought to contain the
      string "ICMP PARAMETER PROBLEM id=00574". This ought to be
      followed by the string "ICMP TIME EXCEEDED id=00574 REAS".
      Neither is strictly required by section 4.2.3.

      The total lack of a response datagram display is also an
      acceptable response.
      An IP Tester display containing "ident = 574 " indicates
      that the IUT improperly reassembled the fragments and passed
      the result to its Remote Driver.

      Success: An optional ICMP Parameter Problem message followed
      by an optional ICMP reassembly timeout message.

      NOTICE: The receipt of an ICMP message (for a fragment with
      a non-zero offset) indicates that the IUT does not conform
      to RFC792.  It is not grounds for the denial of MIL-STD-1777
      certification.

      Failure: An IP Tester datagram display containing "ident =
      574 ".

Test 575 security level mismatch

      -Can the IUT detect a reassembly security level mismatch?

      -Action:  The IP Tester sends a confidential fragment to the
      IP Implementation Under Test. This should cause the IUT to
      create a state vector. The IP Tester will also send an
      unclassified fragment to the IP Implementation Under Test.
      The IUT should then send "an error datagram" (presumably an
      ICMP Parameter Problem message) to the IP Tester to indicate
      that a security level mismatch was detected. The current
      reassembly should be discarded. This is followed by the
      three remaining fragments sent by the IP Tester to the IUT.
      These are not sufficient to reassemble a datagram, so the
      IUT should eventually discard the second reassembly. The IUT
      may send an ICMP reassembly timeout message to the IP
      Tester.

      -Verification: The IP-Tester display ought to contain the
      string "ICMP PARAMETER PROBLEM id=00575". This ought to be
      followed by the string "ICMP TIME EXCEEDED id=00575 REAS".
      Neither is strictly required by section 4.2.3.

      The total lack of a response datagram display is also an
      acceptable response.

      An IP Tester display containing "ident = 575 " indicates
      that the IUT improperly reassembled the fragments and passed
      the result to its Remote Driver.

      Success: An optional ICMP Parameter Problem message followed
      by an optional ICMP reassembly timeout message.

      NOTICE: The receipt of an ICMP message (for a fragment with
      a non-zero offset) indicates that the IUT does not conform
      to RFC792.  It is not grounds for the denial of MIL-STD-1777
      certification.
      Failure: An IP Tester datagram display containing "ident =
      575 ".

Test 576 security level mismatch

      -Can the IUT detect a reassembly security level mismatch?

      -Action:  The IP Tester sends a secret fragment to the IP
      Implementation Under Test. This should cause the IUT to
      create a state vector. The IP Tester will also send a top
      secret fragment to the IP Implementation Under Test. The IUT
      should then send "an error datagram" (presumably an ICMP
      Parameter Problem message) to the IP Tester to indicate that
      a security level mismatch was detected. The current
      reassembly should be discarded. This is followed by the
      three remaining fragments sent by the IP Tester to the IUT.
      These are not sufficient to reassemble a datagram, so the
      IUT should eventually discard the second reassembly. The IUT
      may send an ICMP reassembly timeout message to the IP
      Tester.

      -Verification: The IP Tester display ought to contain the
      string "ICMP PARAMETER PROBLEM id=00576". This ought to be
      followed by the string "ICMP TIME EXCEEDED id=00576 REAS".
      Neither is strictly required by section 4.2.3.

      The total lack of a response datagram display is also an
      acceptable response.

      An IP Tester display containing "ident = 576 " indicates
      that the IUT improperly reassembled the fragments and passed
      the result to its Remote Driver.

      Success: An optional ICMP Parameter Problem message followed
      by an optional ICMP reassembly timeout message.

      NOTICE: The receipt of an ICMP message (for a fragment with
      a non-zero offset) indicates that the IUT does not conform
      to RFC792. It is not grounds for the denial of MIL-STD-1777
      certification.

      Failure: An IP Tester datagram display containing "ident
      576 ".

Test 577 security level mismatch

      -Can the IUT detect a reassembly security level mismatch?

      -Action:  The IP Tester sends an unclassified fragment to
      the IP Implementation Under Test. This should cause the IUT
      to create a state vector. The IP Tester will also send a
      secret fragment to the IP Implementation Under Test. The IUT
      should then send "an error datagram" (presumably an ICMP
      Parameter Problem message) to the IP Tester to indicate that
      a security level mismatch was detected. The current
      reassembly should be discarded. This is followed by the
      three remaining fragments sent by the IP Tester to the IUT.
      These are not sufficient to reassemble a datagram, so the
      IUT should eventually discard the second reassembly. The IUT
      may send an ICMP reassembly timeout message to the IP
      Tester.

     -Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00577". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00577 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     An IP Tester display containing "ident = 577 " indicates
     that the IUT improperly reassembled the fragments and passed
     the result to its Remote Driver.

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message.

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offsat) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: An IP Tester datagram display containing "ident =
     577 ".

Test 578 first compartmentation byte mismatch

     -Can the IUT detect a reassembly compartmentation mismatch?

     -Action:  The IP Tester sends a fragment to the IP
     Implementation Under Test. This should cause the IUT to
     create a state vector. The IP Tester will also send a
     fragment to the IP Implementation Under Test whose first
     compartmentation byte differs from the first fragment's. The
     IUT probably should then send "an error datagram"
     (presumably an ICMP Parameter Problem message) to the IP
     Tester to indicate that a security mismatch was detected.
     The current reassembly probably should be discarded. This is
     followed by the three remaining fragments sent by the IP
     Tester to the IUT. These are not sufficient to reassemble a
     datagram, so the IUT should eventually discard the second
     reassembly. The IUT may send an ICMP reassembly timeout
     message to the IP Tester.
     Because section 9.4.6.3.9.h refers to the fragments'
     security levels, the IUT may reassemble the five fragments
     sent to it by the IP Tester and pass the result to its
     Remote Driver. The IUT's Remote Driver should then request
     the IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00578". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00578 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     If the IUT chooses to reassemble the fragments, the IP
     Tester reply datagram display should display a 22-byte data
     field containing "ident = 578 datalen = ".

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message. Alternately,
     a reply datagram containing "ident = 578 datalen = ".

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offset) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: A datagram other than an ICMP Parameter Problem
     message, an ICMP reassembly timeout message, or the reply
     datagram containing "ident = 578 datalen = ". An ICMP
     message followed by the reply datagram containing "ident =
     578 datalen = " is also a failure.

Test 579 second compartmentation byte mismatch

     -Can the IUT detect a reassembly compartmentation mismatch?

     -Action:  The IP Tester sends a fragment to the IP
     Implementation Under Test. This should cause the IUT to
     create a state vector. The IP Tester will also send a
     fragment to the IP Implementation Under Test whose second
     compartmentation byte differs from the first fragment's. The
     IUT probably should then send "an error datagram"
     (presumably an ICMP Parameter Problem message) to the IP
     Tester to indicate that a security mismatch was detected.
     The current reassembly probably should be discarded. This is
     followed by the three remaining fragments sent by the IP
     Tester to the IUT. These are not sufficient to reassemble a
     datagram, so the IUT should eventually discard the second
     reassembly. The IUT may send an ICMP reassembly timeout
     message to the IP Tester.
     Because section 9.4.6.3.9.h refers to the fragments'
     security levels, the IUT may reassemble the five fragments
     sent to it by the IP Tester and pass the result to its
     Remote Driver. The IUT's Remote Driver should then request
     the IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     -Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00579". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00579 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     If the IUT chooses to reassemble the fragments, the IP
     Tester reply datagram display should display a 21-byte data
     field containing "ident = 579 datalen =".

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message. Alternately,
     a reply datagram containing "ident = 579 datalen =".

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offset) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: A datagram other than an ICMP Parameter Problem
     message, an ICMP reassembly timeout message, or the reply
     datagram containing "ident = 579 datalen =". An ICMP message
     followed by the reply datagram containing "ident = 579
     datalen =" is also a failure.

Test 580 first handling byte mismatch

     -Can the IUT detect a reassembly handling mismatch?

     -Action:  The IP Tester sends a fragment to the IP
     Implementation Under Test. This should cause the IUT to
     create a state vector. The IP Tester will also send a
     fragment to the IP Implementation Under Test whose first
     handling byte differs from the first fragment's. The IUT
     probably should then send "an error datagram" (presumably an
     ICMP Parameter Problem message) to the IP Tester to indicate
     that a security mismatch was detected. The current
     reassembly probably should be discarded. This is followed by
     the three remaining fragments sent by the IP Tester to the
     IUT. These are not sufficient to reassemble a datagram, so
     the IUT should eventually discard the second reassembly. The
     IUT may send an ICMP reassembly timeout message to the IP
     Tester.
     Because section 9.4.6.3.9.h refers to the fragments'
     security- levels, the IUT may reassemble the five fragments
     sent to it by the IP Tester and pass the result to its
     Remote Driver. The IUT's Remote Driver should then request
     the IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     -Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00580". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00580 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     If the IUT chooses to reassemble the fragments, the IP
     Tester reply datagram display should display a 20-byte data
     field containing "ident = 580 datalen ".

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message. Alternately,
     a reply datagram containing "ident = 580 datalen ".

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offset) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: A datagram other than an ICMP Parameter Problem
     message, an ICMP reassembly timeout message, or the reply
     datagram containing "ident = 580 datalen ". An ICMP;message
     followed by the reply datagram containing "ident = 580
     datalen " is also a failure.

Test 581 second handling byte mismatch

     -Can the IUT detect a reassembly handling mismatch?

     -Action:  The IP Tester sends a fragment to the IP
     Implementation Under Test. This should cause the IUT to
     create a state vector. The IP Tester will also send a
     fragment to the IP Implementation Under Test whose second
     handling byte differs from the first fragment's. The IUT
     probably should then send "an error datagram" (presumably an
     ICMP Parameter Problem message) to the IP Tester to indicate
     thst a security mismatch was detected. The current
     reassembly probably should be discarded. This is followed by
     the three remaining fragments sent by the IP Tester to the
     IUT. These are not sufficient to reassemble a datagram, so
     the IUT should eventually discard the second reassembly. The
     IUT may send an ICMP reassembly timeout message to the IP
     Tester.
     Because section 9.4.6.3.9.h refers to the fragments'
     security levels, the IUT may reassemble the five fragments
     sent to it by the IP Tester and pass the result to its
     Remote Driver. The IUT's Remote Driver should then request
     the IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     -Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00581". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00581 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     If the IUT chooses to reassemble the fragments, the IP
     Tester reply datagram display should display a 19-byte data
     field containing "ident = 581 datalen".

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message. Alternately,
     a reply datagram containing "ident = 581 datalen".

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offset) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: A datagram other than an lCMP Parameter Problem
     message, an ICMP reassembly timeout message, or the reply
     datagram containing "ident = 581 datalen". An ICMP message
     followed by the reply datagram containing "ident = 581
     datalen" is also a failure.

Test 582 first transmission control code byte mismatch

     -Can the IUT detect a reassembly TCC mismatch?

     -Action:  The IP Tester sends a fragment to the IP
     Implementation Under Test. This should cause the IUT to
     create a state vector. The IP Tester will also send a
     fragment to the IP Implementation Under Test whose first
     transmission control code byte differs from the first
     fragments.  The IUT probably should then send "an error
     datagram" (presumably an ICMP Parameter Problem message) to
     the IP Tester to indicate that a security mismatch was
     detected. The current reassembly probably should be
     discarded. This is followed by the three remaining fragments
     sent by the IP Tester to the IUT. These are not sufficient
     to reassemble a datagram, so the IUT should eventually
     discard the second reassembly. The IUT may send an ICMP
     reassembly timeout message to the IP Tester.
     Because section 9.4.6.3.9.h refers to the fragments'
     security levels, the IUT may reassemble the five fragments
     sent to it by the IP Tester and pass the result to its
     Remote Driver. The IUT's Remote Driver should then request
     the IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     -Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00582". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00582 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     If the IUT chooses to reassemble the fragments, the IP
     Tester reply datagram display should display a 18-byte data
     field containing "ident = 582 datale".

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message. Alternately,
     a reply datagram containing "ident = 582 datale".

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offset) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: A datagram other than an ICMP Parameter Problem
     message, an ICMP reassembly timeout message, or the reply
     datagram containing "ident = 582 datale". An ICMP message
     followed by the reply datagram containing "ident = 582
     datale" is also a failure.

Test 583 second transmission control code byte mismatch

     -Can the IUT detect a reassembly TCC mismatch?

     -Action:  The IP Tester sends a fragment to the IP
     Implementation Under Test. This should cause the IUT to
     create a state vector. The IP Tester will also send a
     fragment to the IP Implementation Under Test whose second
     transmission control code byte differs from the first
     fragment's. The IUT probably should then send "an error
     datagram" (presumably an ICMP Parameter Problem message) to
     the IP Tester to indicate that a security mismatch was
     detected. The current reassembly probably should be
     discarded. This is followed by the three remaining fragments
     sent by the IP Tester to the IUT. These are not sufficient
     to reassemble a datagram, so the IUT should eventually
     discard the second reassembly. The IUT may send an ICMP
     reassembly timeout message to the IP Tester.
     Because section 9.4.6.3.9.h refers to the fragments,
     security levels, the IUT may reassemble the five fragments
     sent to it by the IP Tester and pass the result to its
     Remote Driver. The IUT's Remote Driver should then request
     the IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     -Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00583". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00583 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     If the IUT chooses to reassemble the fragments, the IP
     Tester reply datagram display should display a 17-byte data
     field containing "ident = 583 datal".

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message. Alternately,
     a reply datagram containing "ident = 583 datal".

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offset) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: A datagram other than an ICMP Parameter Problem
     message, an ICMP reassembly timeout message, or the reply
     datagram containing "ident = 583 datal". An ICMP message
     followed by the reply datagram containing "ident = 583
     datal" is also a failure.

Test 584 third transmission control code byte mismatch

     -Can the IUT detect a reassembly TCC mismatch?

     -Action:  The IP Tester sends a fragment to the IP
     Implementation Under Test. This should cause the IUT to
     create a state vector. The IP Tester will also send a
     fragment to the IP Implementation Under Test whose third
     transmission control code byte differs from the first
     fragment's. The IUT probably should then send "an error
     datagram" (presumably an ICMP Parameter Problem message) to
     the IP Tester to indicate that a security mismatch was
     detected. The current reassembly probably should be
     discarded. This is followed by the three remaining fragments
     sent by the IP Tester to the IUT. These are not sufficient
     to reassemble a datagram, so the IUT should eventually
     discard the second reassembly. The IUT may send an ICMP
     reassembly timeout message to the IP Tester.
     Because section 9.4.6.3.9.h refers to the fragments,
     security levels, the IUT may reassemble the five fragments
     sent to it by the IP Tester and pass the result to its
     Remote Driver. The IUT's Remote Driver should then request
     the IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     -Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00584". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00584 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     If the IUT chooses to reassemble the fragments, the IP
     Tester reply datagram display should display a 16-byte data
     field containing "ident = 584 data".

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message. Alternately,
     a reply datagram containing "ident = 584 data".

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offset) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: A datagram other than an ICMP Parameter Problem
     message, an ICMP reassembly timeout message, or the reply
     datagram containing "ident = 584 data". An ICMP message
     followed by the reply datagram containing "ident = 584 data"
     is also a failure.

Test 585 security level mismatch

     -Can the IUT detect a reassembly security level mismatch?

     -Action:  The IP Tester sends a confidential fragment to the
     IP Implementation Under Test. This should cause the IUT to
     create a state vector. The IP Tester will also send a
     fragment without a security option to the IP Implementation
     Under Test. The IUT should then send "an error datagram"
     (presumably an ICMP Parameter Problem message) to the IP
     Tester to indicate that a security level mismatch was
     detected. The current reassembly should be discarded. This
     is followed by the three remaining fragments sent by the IP
     Tester to the IUT. These are not sufficient to reassemble
     datagram, so the IUT should eventually discard the second
     reassembly. The IUT may send an ICMP reassembly timeout
     message to the IP Tester.
     -Verification: The IP Tester display ought to contain the
     string "ICMP PARAMETER PROBLEM id=00585". This ought to be
     followed by the string "ICMP TIME EXCEEDED id=00585 REAS".
     Neither is strictly required by section 4.2.3.

     The total lack of a response datagram display is also an
     acceptable response.

     An IP Tester display containing "ident = 585 " indicates
     that the IUT improperly reassembled the fragments and passed
     the result to its Remote Driver.

     Success: An optional ICMP Parameter Problem message followed
     by an optional ICMP reassembly timeout message.

     NOTICE: The receipt of an ICMP message (for a fragment with
     a non-zero offset) indicates that the IUT does not conform
     to RFC792.  It is not grounds for the denial of MIL-STD-1777
     certification.

     Failure: An IP Tester datagram display containing "ident =
     585 ".

     Scenario File OpBdRouBotTest: "Bottom-up Bad Routing Option"
     datagrams

2100      truncated loose source and record route option

2101      add one to option length

2102      add another byte to option

2103      remove byte from option

2104      option length of 0

2105      option length of 377

2106      option length of 353

2107      option length of 177

2108      option length of 203

2109      option length of 207

2110      add one to option pointer

2111      subtract one from option pointer

2112      option pointer of 300

2113      option pointer of 174
2114      add twelve to option pointer and option-length

2115      option pointer just past maximum legal value

2116      option pointer just past larger maximum legal value

2117      duplicated option

2118      two different options of same type

2119      normal datagram

2120      truncated strict source and record route option

2121      add one to option length

2122      add another byte to option

2123      remove byte from option

2124      option length of 0

2125      option length of 377

2126      option length of 353

2127      option length of 177

2128      option length of 203

2129      option length of 207

2130      add one to option pointer

2131      subtract one from option pointer

2132      option pointer of 300

2133      option pointer of 174

2134      add twelve to option pointer and option length

2135      option pointer just past maximum legal value

2136      option pointer just past larger maximum legal value

2137      duplicated option

2138      two different options of same type

2139      normal datagram

2140      bad option followed by good option
2141      bad option surrounded by good options

2142      normal datagram

-----------------------------------


Test 2100 truncated loose source and record route option

     -Can the IUT interpret a truncated option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. The first two bytes are no
     operation options (to permit the truncation of the last
     option). Because the address in the option isn't all there,
     the IUT probably should send an ICMP Parameter Problem
     message to the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02lOO". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2100 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2100 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2119).

Test 2101 loose source and record route option length bumped by
one

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. The first byte is a no
     operation option to distinguish this test from Test 2102.
     This is followed by a loose source and record route option
     whose option length has been bumped by one. The IUT may send
     an ICMP Parameter Problem message to the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester.
     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02101". The alternate ICMP Unreachable
     message display must contain the string: "ICMP DESTINATION
     UNREACHABLE id=02101 HOST".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2102 loose source and record route option one byte too long

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This consists of a loose
     source and record route option that is one byte too long.
     The IUT may send an ICMP Parameter Problem message to the IP
     Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester.

     The IUT should always discard the datagram.

     -Verification: If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02102". The alternate ICMP Unreachable
     message display must contain the string: "ICMP DESTINATION
     UNREACHABLE id=02102 HOST".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2103 loose source and record route option one byte too short

     -Can the IUT interpret a defective option?
     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This consists of a loose
     source and record route option that is one byte too short
     followed by an end of option list option and one byte of
     padding. The IUT probably should send an ICMP Parameter
     Problem message to the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02103". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2103 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2103 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2119).

Test 2104 loose source and record route option length of 0

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a loose
     source and record route option with an option length of 0.
     The IUT should discard the datagram. The IUT may send an
     ICMP Parameter Problem message to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02104".A display of an ICMP message
     should indicate that it came from the IUT by containing the
     string "S00701600002".

     Success: An optional ICMP Parameter Problem message.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2119).

Test 2105 loose source and record route option length of 377
octal

     -Can the IUT interpret a defective option length?
     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a loose
     source and record route option with an option length of 377
     octal (neRative 1). The IUT may send an ICMP Parameter
     Problem message to the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02105". The alternate ICMP Unreachable
     message display must contain one of the three strings:  "ICMP
     DESTINATION UNREACHABLE id=02105 HOST", "ICMP DESTINATION
     UNREACHABLE id=02105 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02105 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2106 loose source and record route option length of 353
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a loose
     source and record route option with an option length of 353
     octal. The IUT may send an ICMP Parameter Problem message to
     the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.
     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02106". The alternate ICMP Unreachable
     message display must contain one of the three strings: "ICMP
     DESTINATION UNREACHABLE id=02106 HOST", "ICMP DESTINATION
     UNREACHABLE id=02106 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02106 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2107 loose source and record route option length of 177
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a loose
     source and record route option with an option length of 177
     octal. The IUT may send an ICMP Parameter Problem message to
     the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02107". The alternate ICMP Unreachable
     message display must contain one of the three strings: "ICMP
     DESTINATION UNREACHABLE id=02107 HOST", "ICMP DESTINATION
     UNREACHABLE id=02107 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02107 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.
     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2108 loose source and record route option length of 203
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a loose
     source and record route option with an option length of 203
     octal. The IUT may send an ICMP Parameter Problem message to
     the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02108". The alternate ICMP Unreachable
     message display must contain one of the three strings:  "ICMP
     DESTINATION UNREACHABLE id=02108 HOST", "ICMP DESTINATION
     UNREACHABLE id=02108 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02108 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2109 loose source and record route option length of 207
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a loose
     source and record route option with an option length of 207
     octal (sign bit set). The IUT may send an ICMP Parameter
     Problem message to the IP Tester.
     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02109". The alternate ICMP Unreachable
     message display must contain one of the three strings: "ICMP
     DESTINATION UNREACHABLE id=02109 HOST", "ICMP DESTINATION
     UNREACHABLE id=02109 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02109 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2110 loose source and record route option pointer bumped by
1

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This consists of a loose
     source and record route option whose pointer has been bumped
     by 1. The IUT may send an ICMP Parameter Problem message to
     the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02llO". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2110 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2110 ", or nothing.
      Failure: A failure to pass the next test performed after
      this test that clearly requires a positive response from the
      IUT (Test 2119).

Test 2111 loose source and record route option with pointer 1
short

      -Can the IUT interpret a defective option pointer?

      -Action:  Send a datagram to the IP Implementation Under
      Test with an 8-byte option field. This contains a loose
      source and record route option with an option pointer one
      short of the legal minimum. The IUT may send an ICMP
      Parameter Problem message to the IP Tester.

      The IUT may attempt to forward the datagram instead. Section
      9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
      message to the IP Tester. Section 4.3.1 Gateway IPs may send
      an ICMP Unreachable Net or ICMP Unreachable Source Route
      Failed message. Unless instructed otherwise, the lab will
      consider this behavior conformant.

      The IUT should always discard the datagram.

      -Verification:  If there is a response datagram displayed by
      the IP Tester, its display ought to contain the string "ICMP
      PARAMETER PROBLEM ID=02111". The alternate ICMP Unreachable
      message display must contain one of the three strings: "ICMP
      DESTINATION UNREACHABLE id=02111 HOST", "ICMP DESTINATION
      UNREACHABLE id=02111 NETW", or "ICMP DESTINATION UNREACHABLE
      id=02111 ROUT".

      A display of an ICMP message should indicate that it came
      from the IUT by containing the string "S00701600002".

      Success: An optional ICMP Parameter Problem or ICMP
      Destination Unreachable message.

      Failure: An IP Tester display of a datagram other than an
      ICMP Parameter Problem or ICMP Destination Unreachable
      message.

Test 2112 loose source and record route option pointer of 300
octal

      -Can the IUT interpret a defective option?

      -Action:  Send a datagram to the IP Implementation Under
      Test with an 8-byte option field. This contains a loose
      source and record route option whose pointer has been set to
      300 octal. The IUT may send an ICMP Parameter Problem
      message to the IP Tester and discard the datagram.
     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02112". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2112 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2112", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2119).

Test 2113 loose source and record route option pointer of 174
octal

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a loose
     source and record route option whose pointer has been set to
     174 octal. The IUT may send an ICMP Parameter Problem
     message to the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification: If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02113". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2113 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2113", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2119).
Test 2114 loose source and record route option with bad option
length and option pointer

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a loose
     source and record route option whose option length and
     option pointer have been bumped by 12. The IUT may send an
     ICMP Parameter Problem message to the IP Tester and discard
     the datagram.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02114". The alternate ICMP Unreachable
     message display must contain one of the three strings:  "ICMP
     DESTINATION UNREACHABLE id=02114 HOST", "ICMP DESTINATION
     UNREACHABLE id=02114 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02114 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2115 loose source and record route option with bad option
pointer

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a single
     address loose source and record route option whose pointer
     has been set to just exceed its maximum legal value. The IUT
     may send an ICMP Parameter Problem message to the IP Tester
     and discard the datagram.
     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02115". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2115 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2115 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2119).

Test 2116 loose source and record route option with bad option
pointer

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 12-byte option field. This contains a two
     address loose source and record route option whose pointer
     has been set to just exceed its maximum legal value. The IUT
     may send an ICMP Parameter Problem message to the IP Tester
     and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification: If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02116". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2116 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2116 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2119).
Test 2117 loose source and record route option duplicated

      -Can the IUT interpret a duplicated option?

      -Action:  Send a datagram to the IP Implementation Under
      Test whose option field contains two identical loose source
      and record route options. The IUT may send an ICMP Parameter
      Problem message to the IP Tester.

      The IUT may attempt to forward the datagram instead. Section
      9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
      message to the IP Tester.

      The IUT should always discard the datagram.

      -Verification:  If there is a response datagram displayed by
      the IP Tester, its display ought to contain the string "ICMP
      PARAMETER PROBLEM ID=02117". The alternate ICMP Unreachable
      message display must contain the string: "ICMP DESTINATION
      UNREACHABLE id=02117 HOST".

      A display of an ICMP message should indicate that it came
      from the IUT by containing the string "S00701600002".

      Success: An optional ICMP Parameter Problem or ICMP
      Destination Unreachable message.

      Failure: An IP Tester display of a datagram other than an
      ICMP Parameter Problem or ICMP Destination Unreachable
      message.

Test 2118 two loose source and record route options

      -Can the IUT detect two options of same type ?

      -Action:  Send a datagram to the IP Implementation Under
      Test whose option field contains two loose source and record
      route options. The IUT may send an ICMP Parameter Problem
      message to the IP Tester.

      The IUT may attempt to forward the datagram instead. Section
      9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
      message to the IP Tester.

      The IUT should always discard the datagram.

      -Verification:  If there is a response datagram displayed by
      the IP Tester, its display ought to contain the string "ICMP
      PARAMETER PROBLEM ID=02118". The alternate ICMP Unreachable
      message display must contain the string: "ICMP DESTINATION
      UNREACHABLE id=02118 HOST".

      A display of an ICMP message should indicate that it came
      from the IUT by containing the string "S00701600002".
      Success: An optional ICMP Parameter Problem or ICMP
      Destination Unreachable message.

      Failure: An IP Tester display of a datagram other than an
      ICMP Parameter Problem or ICMP Destination Unreachable
      message.

Test 2119 ordinary datagram after bad LSRR tests

      -Can the IUT send datagram after processing nastygrams?

      -Action:  Send a datagram to the IP Implementation Under
      Test. This datagram should be passed by the IUT to its
      Remote Driver. The IUT's Remote Driver should request the
      IUT to send the reply datagram required by the IP Remote
      Driver Specification to the IP Tester.

      -Verification: The IP Tester will display the reply datagram
      that must contain "ident = 2119 " in its 13-byte data field.

      Success: Display of reply datagram requested to be sent.

      Failure: Any response other than the display of the
      requested reply datagram. The actual failure probably
      occurred during Tests 2100-2116.

Test 2120 truncated strict source and record route option

      -Can the IUT interpret a truncated option?

      -Action:  Send a datagram to the IP Implementation Under
      Test with an 8-byte option field. The first two bytes are no
      operation options (to permit the truncation of the last
      option). Because the address in the option isn't all there,
      the IUT probably should send an ICMP Parameter Problem
      message to the IP Tester and discard the datagram.

      It is possible that the IUT will accept the datagram and
      pass it to its Remote Driver. The IUT's Remote Driver should
      request the IUT to send the reply datagram required by the
      IP Remote Driver Specification to the IP Tester.

      -Verification:  If there is a response datagram displayed by
      the IP Tester, its display ought to contain the string "ICMP
      PARAMETER PROBLEM ID=02120". However, if the IUT chooses to
      pass the datagram to its Remote Driver, the reply datagram
      must contain "ident = 2120 " in its 13-byte data field.

      A display of an ICMP message should indicate that it came
      from the IUT by containing the string "S00701600002".

      Success: An ICMP Parameter Problem message, reply datagram
      containing "ident = 2120 ", or nothing.
     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2139).

Test 2121 strict source and record route option length bumped by
one

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. The first byte is a no
     operation option to distinguish this test from Test 2122.
     This is followed by a strict source and record route option
     whose option length has been bumped by one. The IUT may send
     an ICMP Parameter Problem message to the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02121". The alternate ICMP Unreachable
     message display must contain the string: "ICMP DESTINATION
     UNREACHABLE id=02121 HOST".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2122 strict source and record route option one byte too long

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This consists of a strict
     source and record route option that is one byte too long.
     The IUT may send an ICMP Parameter Problem message to the IP
     Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester.

     The IUT should always discard the datagram.
     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02122". The alternate ICMP Unreachable
     message display must contain the string: "ICMP DESTINATION
     UNREACHABLE id=02122 HOST".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2123 strict source and record route option one byte too
short

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This consists of a strict
     source and record route option that is one byte too short
     followed by an end of option list option and one byte of
     padding. The IUT probably should send an ICMP Parameter
     Problem message to the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02123". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2123 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2123 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2139).

Test 2124 strict source and record route option length of 0

     -Can the IUT interpret a defective option length?
     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option with an option length of 0.
     The IUT should discard the datagram. The IUT may send an
     ICMP Parameter Problem message to the IP Tester.

     -Verification: If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02124".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem message.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2139).

Test 2125 strict source and record route option length of 377
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option with an option length of 377
     octal (negative 1). The IUT may send an ICMP Parameter
     Problem message to the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02125". The alternate ICMP Unreachable
     message display must contain one of the three strings:  "ICMP
     OESTINATION UNREACHABLE id=02125 HOST", "ICMP DESTINATION
     UNREACHABLE id=02125 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02125 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.
     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2126 strict source and record route option length of 353
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option with an option length of 353
     octal. The IUT may send an ICMP Parameter Problem message to
     the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02126". The alternate ICMP Unreachable
     message display must contain one of the three strings: "ICMP
     DESTINATION UNREACHABLE id=02126 HOST", "ICMP DESTINATION
     UNREACHABLE id=02126 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02126 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by contaiining the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2127 strict source and record route option length of 177
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option with an option length of 177
     octal. The IUT may send an ICMP Parameter Problem message to
     the IP Tester.
     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification: If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02127". The alternate ICMP Unreachable
     message display must contain one of the three strings: "ICMP
     DESTINATION UNREACHABLE id=02127 HOST", "ICMP DESTINATION
     UNREACHABLE id=02127 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02127 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2128 strict source and record route option length of 203
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option with an option length of 203
     octal. The IUT may send an ICMP Parameter Problem message to
     the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02128". The alternate ICMP Unreachable
     message display must contain one of the three strings: "ICMP
     DESTINATION UNREACHABLE id=02128 HOST", "ICMP DESTINATION
     UNREACHABLE id=02128 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02128 ROUT".
     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2129 strict source and record route option length of 207
octal

     -Can the IUT interpret a defective option length?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option with an option length of 207
     octal (sign bit set). The IUT may send an ICMP Parameter
     Problem message to the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02129". The alternate ICMP Unreachable
     message display must contain one of the three strings: "ICMP
     DESTINATION UNREACHABLE id=02129 HOST", "ICMP DESTINATION
     UNREACHABLE id=02129 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02129 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2130 strict source and record route option pointer bumped by
1

     -Can the IUT interpret a defective option?
      -Action:  Send a datagram to the IP Implementation Under
      Test with an 8-byte option field. This consists of a strict
      source and record route option whose pointer has been bumped
      by 1. The IUT may send an ICMP Parameter Problem message to
      the IP Tester and discard the datagram.

      It is possible that the IUT will accept the datagram and
      pass it to its Remote Driver. The IUT's Remote Driver should
      request the IUT to send the reply datagram required by the
      IP Remote Driver Specification to the IP Tester.

      -Verification: If there is a response datagram displayed by
      the IP Tester, its display ought to contain the string "ICMP
      PARAMETER PROBLEM ID=02130". However, if the IUT chooses to
      pass the datagram to its Remote Driver, the reply datagram
      must contain "ident = 2130 " in its 13-byte data field.

      A display of an ICMP message should indicate that it came
      from the IUT by containing the string "S00701600002".

      Success: An ICMP Parameter Problem message, reply datagram
      containing "ident = 2130 ", or nothing.

      Failure: A failure to pass the next test performed after
      this test that clearly requires a positive response from the
      IUT (Test 2139).

Test 2131 strict source and record route option with pointer one
short

      -Can the IUT interpret a defective option pointer?

      -Action:  Send a datagram to the IP Implementation Under
      Test with an 8-byte option field. This contains a strict
      source and record route option with an option pointer one
      short of the legal minimum. The IUT may send an ICMP
      Parameter Problem message to the IP Tester.

      The IUT may attempt to forward the datagram instead. Section
      9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
      message to the IP Tester. Section 4.3.1 Gateway IPs may send
      an ICMP Unreachable Net or ICMP Unreachable Source Route
      Failed message. Unless instructed otherwise, the lab will
      consider this behavior conformant.

      The IUT should always discard the datagram.

      -Verification:  If there is a response datagram displayed by
      the IP Tester, its display ought to contain the string "ICMP
      PARAMETER PROBLEM ID=02131". The alternate ICMP Unreachable
      message display must contain one of the three strings: "ICMP
      DESTINATION UNREACHABLE id=02131 HOST", "ICMP DESTINATION
      UNREACHABLE id=02131 NETW", or "ICMP DESTINATION UNREACHABLE
      id=02131 ROUT".
     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2132 strict source and record route option pointer of 300
octal

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option whose pointer has been set to
     300 octal. The IUT may send an ICMP Parameter Problem
     message to the IP Tester and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02132". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2132 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2132 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2139).

Test 2133 strict source and record route option pointer of 174
octal

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option whose pointer has been set to
     174 octal. The IUT may send an ICMP Parameter Problem
     message to the IP Tester and discard the datagram.
     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02133". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2133 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2133 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2139).

Test 2134 strict source and record route option with bad option
length and option pointer

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a strict
     source and record route option whose option length and
     option pointer have been bumped by 12. The IUT may send an
     ICMP Parameter Problem message to the IP Tester and discard
     the datagram.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester. Section 4.3.1 Gateway IPs may send
     an ICMP Unreachable Net or ICMP Unreachable Source Route
     Failed message. Unless instructed otherwise, the lab will
     consider this behavior conformant.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02134". The alternate ICMP Unreachable
     message display must contain one of the three strings:  "ICMP
     DESTINATION UNREACHABLE id=02134 HOST", "ICMP DESTINATION
     UNREACHABLE id=02134 NETW", or "ICMP DESTINATION UNREACHABLE
     id=02134 ROUT".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".
     Success:  An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2135 strict source and record route option with bad option
pointer

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 8-byte option field. This contains a single
     address strict source and record route option whose pointer
     has been set to just exceed its maximum legal value. The IUT-
     may send an ICMP Parameter Problem message to the IP Tester
     and discard the datagram.

     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02135". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2135 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2135 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2139).

Test 2136 strict source and record route option with bad option
pointer

     -Can the IUT interpret a defective option?

     -Action:  Send a datagram to the IP Implementation Under
     Test with an 12-byte option field. This contains a two
     address strict source and record route option whose pointer
     has been set to just exceed its maximum legal value. The IUT
     may send an ICMP Parameter Problem message to the IP Tester
     and discard the datagram.
     It is possible that the IUT will accept the datagram and
     pass it to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     -Verification:  If there is a response datagram displayed by
     the IP Test-r, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02136". However, if the IUT chooses to
     pass the datagram to its Remote Driver, the reply datagram
     must contain "ident = 2136 " in its 13-byte data field.

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An ICMP Parameter Problem message, reply datagram
     containing "ident = 2136 ", or nothing.

     Failure: A failure to pass the next test performed after
     this test that clearly requires a positive response from the
     IUT (Test 2139).

Test 2137 strict source and record route option duplicated

     -Can the IUT interpret a duplicated option?

     -Action:  Send a datagram to the IP Implementation Under
     Test whose option field contains two identical strict source
     and record route options. The IUT may send an ICMP Parameter
     Problem message to the IP Tester.

     The IUT may attempt to forward the datagram instead. Section
     9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
     message to the IP Tester.

     The IUT should always discard the datagram.

     -Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain the string "ICMP
     PARAMETER PROBLEM ID=02137". The alternate ICMP Unreachable
     message display must contain the string: "ICMP DESTINATION
     UNREACHABLE id=02137 HOST".

     A display of an ICMP message should indicate that it came
     from the IUT by containing the string "S00701600002".

     Success: An optional ICMP Parameter Problem or ICMP
     Destination Unreachable message.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem or ICMP Destination Unreachable
     message.

Test 2138 two strict source and record route options

	-Can the IUT detect two options of same type?

	-Action:  Send a datagram to the IP Implementation Under
	Test whose option field contains two strict source and
	record route options.  The IUT may send an ICMP Parameter
	Problem message to the IP Tester.

	The IUT may attempt to forward the datagram instead.  Section
	9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
	message to the IP Tester.

	The IUT should always discard the datagram.

	-Verification:  If there is a response datagram displayed by
	the IP Tester, its display ought to contain the string "ICMP
	PARAMETER PROBLEM ID=02138."  The alternate ICMP Unreachable	
	message display must contain the string:  "ICMP DESTINATION
	UNREACHABLE id-02138 HOST."

	A display of an ICMP message should indicate that it came
	from the IUT by containing the string "S00701600002."

	Success:  An optional ICMP Parameter Problem or ICMP
	Destination Unreachable message.

	Failure:  An IP Tester display of a datagram other than an
	ICMP Parameter Problem or ICMP Destination Unreachable
	message.


Test 2139 ordinary datagram after bad SSRR Tests

	-Can the IUT send datagram after processing nastygrams?

	-Action:  Send a datagram to the IP Implementation Under
	Test.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	-Verification:  The IP Tester will display the reply datagram
	that must contain "ident = 2139" in its 13-byte data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.  The actual failure probably
	occurred during Tests 2120-2136.

Test 2140 bad loose source and record route and good stream ID 
option

	-Can the IUT remember detecting a bad option?

	-Action:  Send a datagram to the IP Implementation Under
	Test whose option field contains a bad loose source and
	record route option followed by a good stream identification
	option.  The IUT may send an ICMP Parameter Problem message
	to the IP Tester.

	The IUT may attempt to forward the datagram instead.  Section
	9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
	message to the IP Tester.  Section 4.3.l Gateway IPs may send
	an ICMP Unreachable Net or ICMP Unreachable Source Route
	Failed message.  Unless instructed otherwise, the lab will
	consider this behavior conformant.

	The IUT should always discard the datagram.

	-Verification:  If there is a response datagram displayed by
	the IP Tester, its display ought to contain the string "CIMP
	PARAMETER PROBLEM ID=02140."  The alternate ICMP Unreachable
	message display must contain one of the three strings:  "ICMP
	DESTINATION UNREACHABLE id=02140 HOST," ICMP DESTINATION
	UNREACHABLE id=02140 NETW," or " ICMP DESTINATION UNREACHABLE 
	id=02140 ROUT."

	A display of an ICMP message should indicate that it came
	from the IUT by containing the string "S00701600002."

	Success:  An optional ICMP Parameter Problem or ICMP
	Destination Unreachable message.

	Failure:  An IP Tester display of a datagram other than an
	ICMP Parameter Problem or ICMP Destination Unreachable
	messagae.

Test 2141 bad loose source and record route and two good security
options

	-Can the IUT remember detecting a bad option?

	-Action:  Send a datagram to the IP Implementation Under
	Test whose option field contains a good unclassified
	security option followed by a bad loose source and record
	route option followed by a good top secret security option.
	The IUT may send an ICMP Parameter Problem message to the IP
	Tester.

	The IUT may attempt to forward the datagram instead.  Section
	9.4.6.1.2 (Host) IPs may send an ICMP Unreachable Host
	message to the IP Tester.  Section 4.3.1 Gateway IPs may send
	an ICMP Unreachable Net or ICMP Unreachable Source Route
	Failed message.  Unless instructed otherwise, the lab will
	consider this behavior conformant.

	The IUT should always discard the datagram.

	-Verification:  If there is a response datagram displayed by
	the IP Tester, its display ought to contain the string "ICMP 
	PARAMETER PROBLEM ID+02141."  The alternate ICMP Unreachable
	message display must contain one of the three strings:  "ICMP
	DESTINATION UNREACHABLE id=02141 HOST," "ICMP DESTINATION
	UNREACHABLE id=02141 NETW," or "ICMP DESTINATION UNREACHABLE
	id-02141 ROUT."

	A display of an ICMP message should indicate that it came
	from the IUT by containing the string "S00701600002."

	Success: An optional ICMP Parameter Problem or ICMP
	Destination Unreachable message.

	Failure:  An IP Tester display of a datagram other than an
	ICMP Parameter Problem or ICMP Destination Unreachable
	message.

Test 2142 ordinary datagram after bad source routing tests

	-Can the IUT send datagram after processing nastygrams?

	-Action:  Send a datagram to the IP Implementation Under
	Test.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the 
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	-Verification:  The IP Tester will display the reply datagram
	that must contain "ident = 2142" in its 13-byte data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.  Failure of this test is the most
	critical failure in the scenario.

Scenario File OpBdRouTopTest:  "Top-down Bad Routing Option"
datagram

4100	truncated loose source and record route option

4101	add one to option length

4102	add another byte to option

4103	remove byte from option

4104	option length of 0

4105	option length of 377
	
4106	option length of 353

4107	option length of 177

4108	option length of 203

4109	option length of 207

4110	add one to option pointer

4111	subtract one from option pointer

4112	option pointer of 300

4113	option pointer of 174

4114	add twelve to option pointer and option length

4115	option pointer just past maximum legal value

4116	option pointer just past larger maximum legal value

4117	duplicated option

4118	two different options of same type

4119	normal datagram

4120	truncated strict source and record route option

4121	add one to option length

4122	add another byte to option

4123	remove byte from option

4124	option length of 0

4125	option length of 377

4126	option length of 353

4127	option length of 177

4128	option length of 203

4129	option length of 207

4130	add one to option pointer

4131	subtract one from option pointer

4132	option pointer of 300

4133	option pointer of 174

4134	add twelve to option pointer and option length

4135	option pointer just past maximum legal value

4136	option pointer just past larger maximum legal value

4137	duplicated option

4138	two different options of same type

4139	normal datagram

4140	bad option followed by good option

4141	bad option surrounded by good options

4142	normal datagram.

----------------------------

Test 4100 truncated loose source and record route option

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under 
	Test containing a remote Driver command request for the IUT
	to send a datagram with an 8-byte option field.  This
	datagram should be passed by the IUT to its Remote Driver.
	The IUT's Remote Driver should request the IUT to send the 
	reply datagram required by the IP Remote Driver
	Specification to the IP Tester.  The first two bytes of the
	invalid option field that the IUT is requested to send are 
	no operation options (to permit the truncation of the loose
	source and record route option).  The IUT is required to
	inform its Remote Driver that the request is invalid.  The 
	Remote Driver should then request the IUT to send an IP

	Remote Driver Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4100 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain 
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4101 loose source and record route option length bumped by
one

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an 8-byte option field.  This
	datagram should be passed by the IUT to its Remote Driver
	The IUT's Remote Driver should request the IUT to send the
	reply datagram required by the IP Remote Driver
	Specification to the IP Tester.  The first byte of the
	invalid option field that the IUT is requested to send is a
	no operation option.  This is followed by a loose source and
	record route option whose option length is one more than it 
	should be.  The IUT is required to inform its Remote Driver
	that the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4101 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4102 loose source and record route option one byte too long

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an 8-byte option field.  This
	datagram should be passed by the IUT to its Remote Driver.

	The IUT's Remote Driver should request the IUT to send the
	reply datagram required by the IP Remote Driver
	Specification to the IP Tester.  The option field contains a
	loose source and record route option whose length is one
	more byte than it should be.  The IUT is required to inform
	its Remote Driver that the request is invalid.  The Remote
	Driver should then request the IUT to send an IP Remote
	Driver Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4102 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain 
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4103 loose source and record route option one byte too short

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose length is one less byte than it
	should be.  The IUT is required to inform its Remote Driver
	that the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "Ident = 4103 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
       	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4104 loose source and record route option length of 0

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option length is set to 0.  The IUT
	is required to inform its Remote Driver that the request is
	invalid.  The Remote Driver should then request the IUT to
	send an IP Remote Driver Specification error message to the 	
	IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4104 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram

	Failure:  Any response other than the display of the error
	message datagram.

Test 4105 loose source and record route option length of 377
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option length is set to 377 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "indent = 4105 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4106 loose source and record route option length of 353
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option length is set to 353 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4106 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4107 loose source and record route option length of 177
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option length is set to 177 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4107 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4108 loose source and record route option length of 203
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option length is set to 203 octal.
	The IUT is required to inform its Remote Driver that the 
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4108 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4109 loose source and record route option length of 207
octal

	-Can the IUT detect an option that is't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option length is set to 207 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	The IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4109 error" in its 18-
	byte data field.  The IP Tester should also display "IHL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4110 loose source and record route option pointer bumped by 
1

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	the record route option whose option pointer is one more than it
	should be.  The IUT is required to inform its Remote Driver
	that the request is invalid.  the Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4110 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4111 loose source and record route option pointer one short

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option pointer is one less than it

	should be.  The IUT is required to inform its Remote Driver
	that the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specificiation
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "indent = 4111 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.
	
	Failure:  Any response other than the display of the error
	message datagram.

Test 4112 loose source and record route option pointer of 300
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option pointer is set to 300
	octal.  The IUT is required to inform its Remote Driver that 
	the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4112 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram

	Failure:  Any response other than the display of the error
	message datagram.

Test 4113 loose source and record route option pointer of 174 
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  the option field contains a loose source and
	record route option whose option pointer is set to 174
	octal.  The IUT is required to inform its Remote Driver that
	the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  Thge IP Tester will display the error message
	datagram that must contain "ident = 4113 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4114 loose source and the record route with bad option length
and option pointer

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a loose source and
	record route option whose option length and option pointer
	have both been bumped by 12.  The IUT is required to inform
	its Remote Driver that the request is invalid.  The Remote
	Driver should then request the IUT to send an IP Remote
	Driver Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4114 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error messaage datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4115 loose source and record route option with bad option
pointer

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Dirver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a single address
	loose source and record route option whose option pointer is
	set to just its maximum (at any IP) legal value.  The IUT is
	required to inform its Remote Driver that the request is
	invalid.  The Remote Driver should then request the IUT to
	send an IP Remote Driver Specification error message to the
	IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4115 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4116 loose source and record route option with bad option
pointer

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a two address loose
	source and record route option whose option pointer is set
	to just its maximum (at any IP) legal value.  The IUT is
	required to inform its Remote Driver that the request is
	invalid.  The Remote Driver should then request the IUT to
	send an IP Remote Driver Specification error message to the
	IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4116 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4117 loose source and record route option duplicated

	-Can the IUT detect an option field that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains two identical loose
	source and record route options.  The IUT is required to
	inform its Remote Driver that the request is invalid.  The
	Remote Driver should then request the IUT to send an IP
	Remote Driver Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4117 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the errror message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4118 two loose source and record route options

	-Can the IUT detect an option field that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains two loose source
	and record route options.  The IUT is required to inform its

	Remote Driver that the request is invalid.  The Remote Driver
	should then request the IUT to send an IP Remote Driver
	Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4118 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4119 ordinary datagram after bad LSRR Tests

	-Can the IUT send datagram after processing nasty requests?

	-Action:  Send a datagram to the IP Implementation Under
	Test.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	-Verification:  The IP Tester will display the reply datagram
	that must contain "ident = 4119" in its 13-byte data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.

Test 4120 truncated strict source and record route option

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an 8-byte option field.  This
	datagram should be passed by the IUT to its Remote Driver.
	The IUT's Remote Driver should request the IUT to send the
	reply datagram required by the IP Remote Driver
	Specification to the IP Tester.  The first two bytes of the
	invalid option field that the IUT is requested to send are
	no operation options (to permit the truncation of the strict
	source and record route option).  The IUT is required to
	inform its Remote Driver that the request is invalid.  The
	Remote Driver should then request the IUT to send an IP
	Remote Driver Specification error message to the IP Tester.

	-Verificatioon:  The IP Tester will display the error message
	datagram that must contain "ident = 4120 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4121 strict source and record route option length bumped by
1

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an 8-byte option field.  This
	datagram should be passed by the IUT to its Remote Driver.
	The IUT's Remote Driver should request the IUT to send the
	reply datagram required by the IP Remote Driver
	Specification to the IP Tester.  The first byte of the
	invalid option field that the IUT is requested to send is a
	no operation option.  This is followed by a strict source and 
	record route option whose option length is one more than it
	should be.  The IUT is required to inform its Remote Driver
	that the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4121 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4122 strict source and record route option one byte too long

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an 8-byte option field.  This
	datagram should be passed by the IUT to its Remote Driver.
	The IUT's Remote Driver should request the IUT to send the
	reply datagram required by the IP Remote Driver

	Specification to the IP Tester.  The option field contains a
	strict source and record route option whose length is one
	more byte than it should be.  The IUT is required to inform
	its Remote Driver that the request is invalid.  The Remote
	Driver should then request the IUT to send an IP Remote
	Driver Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4122 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4123 strict source and record route option one byte too
short

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose length is one less byte than it
	should be.  The IUT is required to inform its Remote Driver
	that the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4123 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4124 strict source and record route option length of 0

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the Ip Tester.  The option field contains a strict source and
	record route option whose option length is set to 0.  The IUT
	is required to inform its Remote Driver that the request is 
	invalid.  The Remote Driver should then request the IUT to
	send an IP Remote Driver Specification error message to the
	IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4124 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4125 strict source and record route option length of 377
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option length is set to 377 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4125 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4126 strict source and record route option length of 353
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option length is set to 353 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.
	
	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4126 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4l27 strict source and record route option length of l77
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option length is set to 177 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4127 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4128 strict source and record route option length of 203
octal

	_Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply 
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option length is set to 203 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4128 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any reponse other than the display of the error
	message datagram.

Test 4129 strict source and record route option length of 207
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option length is set to 207 octal.
	The IUT is required to inform its Remote Driver that the
	request is invalid.  The Remote Driver should then request
	the IUT to send an IP Remote Driver Specification error
	message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4129 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4130 strict source and record route option pointer bumped by
1

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option pointer is one more than it
	should be.  The IUT is required to inform its Remote Driver
	that the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4130 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4131 strict source and record route option pointer one short

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option pointer is one less than it

	should be.  The IUT is required to inform its Remote Driver
	that the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4131 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.
	
	Failure:  Any response other than the display of the error
	message datagram.

Test 4132 strict source and record route option pointer of 300
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option pointer is set to 300
	octal.  The IUT is required to inform its Remote Driver that
	the request is invalid.  The Remote Driver  should then
	request the IUT to send an IP Remote Driver Specification
	error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4132 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4133 strict source and record route option pointer of 174
octal

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option pointer is set to 174
	octal.  The IUT is required to inform its Remote Driver that
	the request is invalid.  The Remote Driver should then
	request the IUT to send an IP Remote Driver Specification 
	Error Message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4133 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4134 strict source and record route with bad option length
and option pointer

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a strict source and
	record route option whose option length and option pointer
	have both been bumped by 12.  The IUT is required to inform
	its Remote Driver that the request is invalid.  The Remote
	Driver should then request the IUT to send an IP Remote
	Driver Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4134 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4135 strict source and record route option with bad option
pointer

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a single address
	strict source and record route option whose option pointer
	is set to just its maximum (at any IP) legal value.  The IUT
	is required to inform its Remote Driver that the request is
	invalid.  The Remote Driver should then request the IUT to
	send an IP Remote Driver Specification error message to the
	IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4135 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4136 strict source and record route option with bad option
pointer

	-Can the IUT detect an option that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a two address
	strict source and record route option whose option pointer
	is set to just its maximum (at any IP) legal value.  The IUT
	is required to inform its Remote Driver that the request is
	invalid.  The Remote Driver should then request the IUT to
	send an IP Remote Driver Specification error message to the
	IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4136 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"

	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain	
	the invalid option field in its IP header.

	Success:  Display of error message datagram.
	
	Failure:  Any response other than the display of the error
	message datagram.

Test 4137 strict source and record route option duplicated

	-Can the IUT detect an option field that isn't well-formed?
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains two identical
	strict source and record route options.  The IUT is required
	to inform its Remote Driver that the request is invalid.  The
	Remote Driver should then request the IUT to send an IP
	Remote Driver specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4137 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4138 two strict source and record route options

	-Can the IUT detect an option field that isn't well-formed?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains two strict source
	and record route options.  The IUT is required to inform its
	Remote Driver that the request is invalid.  The Remote Driver
	should then request the IUT to send an IP Remote Driver
	Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4138 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4139 ordinary datagram after bad SSRR Tests

	-Can the IUT send datagram after processing nasty requests?

	-Action:  Send a datagram to the IP Implementation Under
	Test.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	-Verification:  The IP Tester will display the reply datagram
	that must contain "ident = 4139" in its 13-byte data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.

Test 4140 bad loose source and record route and good stream ID
option

	-Can the IUT remember detecting a bad option?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains a bad loose source
	and record route option followed by a good stream
	identification option.  The IUT is required to inform its
	Remote Driver that the request is invalid.  The Remote Driver
	should then request the IUT to send an IP Remote Driver
	Specification error message to the IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4140 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failuree:  Any response other than the display of the error
	message datagram.

Test 4141 loose source and record route and two good security
options

	-Can the IUT remember detecting a bad option?

	-Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with an option field.  This datagram
	should be passed by the IUT to its Remote Driver.  The IUT's
	Remote Driver should request the IUT to send the reply
	datagram required by the IP Remote Driver Specification to
	the IP Tester.  The option field contains an unclassified 
	security option followed by a bad loose source and record
	route option followed by a top secret security option.  The
	IUT is required to inform its Remote Driver that the request
	is invalid.  The Remote Driver should then request the IUT to
	send an IP Remote Driver Specification error message to the 
	IP Tester.

	-Verification:  The IP Tester will display the error message
	datagram that must contain "ident = 4141 error" in its 18-
	byte data field.  The IP Tester should also display "HL5"
	(internet header length is 5 four-octet units long) to
	indicate that the error message datagram does not contain
	the invalid option field in its IP header.

	Success:  Display of error message datagram.

	Failure:  Any response other than the display of the error
	message datagram.

Test 4142 ordinary datagram after bad SSRR Tests

	-Can the IUT send datagram after processing nasty requests?

	-Action:  Send a datagram to the IP Implementation Under
	Test.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Reote Driver should request the
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	-Verification:  The IP Tester will display the reply datagram
	that must contain "ident = 4142" in its 13-byte data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the 
	requested reply datagram.

Scenario File OpGlDstBotTest:  "One Gateway Destination" datagram

1300	loose source and record route

1308	strict source and record route

1313	loose source and record route +
	strict source and record route +
	record route + prespecified timestamp

1314	prespecified timestamp + record route +
	strict source and record route +
	loose source and record route

1322	fragmented datagram containing record route option

---------------------------------

Test 1300 loose source and record route

	- Can the IUT receive a datagram loose routed to it?

	- Action:  Send a datagram to the IP Implementation Under
	Test containing a loose source and record route option
	indicating that all the required gateways have been
	traversed.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 1300 " in its 1300 " in its 13-byte
	data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the 
	requested reply datagram.

Test 1308 strict source and record route

	- Can the IUT receive a datagram strictly routed to it?

	- Action:  Send a datagram to the IP Implementation Under
	Test containing a strict source and record route option
	indicating that all the required gateways have been
	traversed.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	- Verification:  The IP Tester will display the reply 
	datagram that must contain "ident = 1308 " in its 13 byte
	data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.

Test 1308 strict source and record route

	- Can the IUT receive a datagram strictly routed to it?

	- Action:  Send a datagram to the IP Implementation Under
	Test containing a strict source and record route option
	indicating that all the required gateways have been
	traversed.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the 
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 1308 " in its 13-byte
	data field.

	Success:  Display of reply datagram requested to be sent.
	
	Failure:  Any response other than the display of the
	requested reply datagram.

Test 1313 loose source and record route +
	  strict source and record route +
	  record route + prespecified timestamp

	- Can the IUT receive a datagram loosely and strictly routed
	to it?

	- Action:  Send a datagram to the IP Implementation Under
	Test containing a loose source and record route option, a
	strict source and record route option, a record route
	option, and a prespecified timestamp option.  Each source
	routing option indicates that all the required gateways
	have been traversed.  This datagram should be passed by the
	IUT to its Remote Driver.  The IUT's Remote Driver should
	request the IUT to send the reply datagram required by the
	IP Remote Driver Specification to the IP Tester.

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 1313 " in its 13-byte
	data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.

Test 1314 prespecified timestamp + record route +
	  strict source and record route +
	  loose source and record route

	- Can the IUT receive a datagram strictly and loosely routed
	to it?

	- Action:  Send a datagram to the IP Implementation Under
	Test containing a prespecified timestamp option, a record
	route option, a strict source and record route option, and
	a loose source and record route option.  Each source routing
	option indicates that all the required gateways have been
	traversed.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 1314 " in its 13-byte
	data field.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.

Test 1322 fragmented datagram containing record route option

	- Can the IUT reassemble fragmented datagram containing a
	record route option?

	- Action:  Send a datagram containing a record route option
	(among others) fragmented into two fragments to the IP
	Implementation Under Test.  These fragments should be
	reassembled and the result passed by the IUT to its Remote
	Driver.  The IUT's Remote Driver should request the IUT to
	send the reply datagram required by the IP Remote Driver
	Specification to the IP Tester.

	- Verification:  The IP Tester will display the reply	
	datagram that must contain "ident = 1322 " in its 13-byte
	data field.
	
	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.

Scenario File OpGlSrcBotTest:  "One Gateway Source" datagrams

	CONFIGURATION NOTES:  This scenario requires a different
configuration than that normally used because it is used for
gateway testing.  DCA must provide another network directly
connected to the IUT besides the EDN so the gateway IUT lies
between two networks as required by MIL-STD-1777 section 3.l.j.

	An IP host implementation and IP Remote Driver must be
installed in the other network.  The IP Remote Dirver Specification
requires the implementor to provide both of these items as well as
the gateway.

	NOTICE:  MIL-STD-1777 states that it "specifies a host IP."  It
is not clear that a gateway can or must conform to the standard.

1100	loose source and record route

1108	strict source and record route

1113	loose source and record route +
	strict source and record route +
	record route + timestamp and address timestamp

1114	timestamp and address timestamp + record route +
	strict source and record route +
	loose source and record route

Test 1100 loose source and record route

	- Can the IUT forward a loosely routed datagram?

	- Action:  Send a datagram to the host IP via the gateway IUT.
	This should be passed to the host IP's Remote Driver.  The
	Remote Driver and conformant host IP should then arrange to
	send a reply datagram to the gateway IUT containing a loose
	source and record route option indicating that the datagram
	should be forwarded to the IP Tester.  This datagram should be
	

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 1100 " in its data
	field.  In addition, the display should contain "LOOSE
	len=011 ptr=008 00701600002 00702600002" to indicate that 
	the option was properly processed.

	Success:  Display of forwarded reply datagram.

	Failure:  Any response other than the display of the
	forwarded reply datagram.

Test 1108 strict source and record route

	- Can the IUT forward a strictly routed datagram?

	- Action:  Send a datagram to the host IP via the gateway IUT.
	This should be passed to the host IP's Remote Driver.  The
	Remote Driver and conformant host IP should then arrange to
	send a reply datagram to the gateway IUT containing a stict
	source and record route option indicating that the datagram
	should be forwarded to the IP Tester.  This datagram should be
	forwarded by the gateway IUT to the IP Tester.

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 1108 " in its data
	field.  In addition, the display should contain "STRICT
	len=011 ptr=008 00701600002 00702600002" to indicate that
	the option was properly processed.

	Success:  Display of forwarded reply datagram.

	Failure:  Any response other than the display of the
	forwarded reply datagram.

Test 1113 loose source and record route +
	  strict source and record source +
	  Record route + timestamp and address timestamp

	- Can the IUT forward a loosely and strictly routed diagram?
	
	- Action:  Send a datagram to the host IP via the gateway IUT.
	This should be passed to the host IP's Remote Driver.  The
	Remote Driver and conformant host IP should then arrange to
	send a reply datagram to the gateway IUT containing a loose
	source and record route option, and a timestamp and
	address timestamp option.  Each source routing option indicates
	that the datagram should be forwarded to the IP Tester.  This
	datagram should be forwarded by the gateway IUT to the IP
	Tester.

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 1113 " in its data
	field.  In addition, the display should contain "LOOSE
	len=011 ptr=008 00701600002 00702600002", "STRICT len-011
	ptr=008 00701600002 00702600002", "ROUTE len=007 ptr=008
	00701600002", and "TIMESTAMP len=012 ptr=013 ovr=00 ALLGT
	00701600002" to indicate that the options were properly
	processed.  The line containing "TIMESTAMP" should contain a
	non-zero value after "00701600002" to indicate that the
	option was timestamped.

	Success:  Display of forwarded reply datagram.

	Failure:  Any response other than the display of the
	forwarded reply datagram.

Test 1114 timestamp and address timestamp + record route +
	  strict source and record route +
	  loose source and record route

	- Can the IUT forward a strictly and loosely routed datagram?

	- Action:  Send a datagram to the host IP via the gateway IUT.
	This should be passed to the host IP's Remote Driver.  The
	Remote Driver and conformant host IP should then arrange to
	send a reply datagram to the gateway IUT containing a
	timestamp and address timestamp option, a record route option,
	a strict source and record route option, and a loose source
	and record route option.  Each source routing option indicates
	that the datagram should be forwarded to the IP Tester.  This
	datagram should be forwarded by the gateway IUT to the IP
	Tester.

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 1114 " in its data
	field.  In addition, the display should contain "LOOSE
	len=011 ptr=008 00701600002 00702600002", "STRICT len=011
	ptr=008 00701600002 00702600002", "ROUTE len=007 ptr=008
	00701600002", and "TIMESTAMP len-012 ptr=013 ovr=00 ALLGT
	00701600002", to indicate that the options were properly
	processed.  The line containing "TIMESTAMP" should contain a
	non-zero value after "00701600002" to indicate that the
	option was timestamped.

	Success:  Display of forwarded reply datagram.

	Failure:  Any response other than the display of the
	forwarded reply datagram.

Scenario File OpGlSrcTopTest: "One Gateway Source" datagrams

3100	Loose source and record route

3108	strict source and record route

3113	loose source and record route +
	strict source and record route +
	record route + prespecified timestamp

3114	prespecified timestamp + record route +
	strict source and record route +
	loose source and record route

3122	record route + no operation +
	stream identification +
	unclassified security +
	end of options list

---------------------------------

Test 3100 loose source and record route

	- Can the IUT send a loosely routed datagram?

	- Action:  Send a datagram to the IP Implementation Under
	Test containing a Remote Driver command request for the IUT
	to send a datagram with a loose source and record route
	option.  This datagram should be passed by the IUT to its
	Remote Driver.  The IUT's Remote Driver should request the
	IUT to send the reply datagram required by the IP Remote
	Driver Specification to the IP Tester.

	- Verification:  The IP Tester will display the reply
	datagram that must contain "ident = 3100 " in its data
	field.  In addition, the display should contain "LOOSE
	len=011 ptr=004 00702600002 03200200001" to indicate that
	the option was not improperly processed.

	Success:  Display of reply datagram requested to be sent.

	Failure:  Any response other than the display of the
	requested reply datagram.

Test 3108 strict source and record route

	- Can the IUT send a strictly routed datagram?

     - Action:   Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a strict source and record route
     option. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3108 " in its data
     field. In addition, the display should contain "STRICT
     len=011 ptr=004 00702600002 03200200001" to indicate that
     the option was not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 3113 loose source and record route +
          strict source and record route +
          record route + prespecified timestamp

     - Can the IUT send a loosely and strictly routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a loose source and record route
     option, a strict source and record route option, a record
     route option, and a prespecified timestamp option. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3113 " in its data
     field. In addition, the display should contain "LOOSE
     len=011 ptr=004 00702600002 03200200001", "STRICT len=011
     ptr=004 00702600002 03200200001", "ROUTE len=007 ptr=004
     00000000000", and "TIMESTAMP len=012 ptr=005 ovr=00 MATCH
     00702600002 00000000000" to indicate that the options were
     not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested-reply datagram.

Test 3114 prespecified timestamp + record route +
          strict source and record route +
          loose source and record route
     - Can the IUT send a strictly and loosely routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a prespecified timestamp option, a
     record route option, a strict source and record route
     option, and a loose source and record route option. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3114 " in its data
     field.  In addition, the display should contain "LOOSE
     len=011 ptr=004 00702600002 03200200001", "STRICT len=011
     ptr=004 00702600002 03200200001", "ROUTE len=007 ptr=004
     00000000000", and "TIMESTAMP len=012 ptr=005 ovr=00 MATCH
     00702600002 00000000000" to indicate that the options were
     not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 3122 record route + no operation +
          stream identification +
          unclassified security +
          end of options list

     - Can the IUT send a datagram with many different options?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a record route option, a no
     operation option, a stream identification option, an
     unclassified security option, and an end of options list
     option. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3122 " in its data
     field. In addition, the display should contain "SEC UNCL
     comp=00000 hand=hh tcc=tcc", "ROUTE len=007 ptr=004
     00000000000", "STREAM 21589" to indicate that the options
     were not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Scenario File OpG2DstBotTest: "Two Gateway Destination" datagrams

1301      loose source and record route

1309      strict source and record route

1311      fragmented datagram with strict source and record route

1315      loose source and record route +
          record route +
          strict source and record route

1316      strict source and record route +
          record route +
          loose source and record route

1317      loose source and record route +
          timestamp only timestamp +
          strict source and record route

1318      strict source and record route +
          timestamp only timestamp +
          loose source and record route

1319      loose source and record route +
          prespecified timestamp +
          strict source and record route

1320      strict source and record route +
          prespecified timestamp +
          loose source and record route

1321      fragmented datagram with
          strict source and record route +
          prespecified timestamp +
          loose source and record route

1323      out-of-order fragmented datagram with
          strict source and record route +
          prespecified timestamp +
          loose source and record route



Test 1301 loose source and record route

     - Can the IUT receive a datagram loosely routed to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a loose source and record route option
     indicating that all the required gateways have been
     traversed. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1301 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1309 strict source and record route

     - Can the IUT receive a datagram strictly routed to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a strict source and record route option
     indicating that all the required gateways have been
     traversed. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1309 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1311 fragmented datagram containing a strict source and
          record route option

     - Can the IUT reassemble fragmented datagram containing a
     strict source and record route option?

     - Action:  Send a datagram containing a strict source and
     record route option fragmented into two fragments to the IP
     Implementation Under Test. These fragments should be
     reassembled and the result passed by the IUT to its Remote
     Driver. The IUT's Remote Driver should request the IUT to
     send the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1311 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.
     Failure: Any response other than the display of the
     requested reply datagram.

Test 1315 loose source and record route +
          record route +
          strict source and record route

     - Can the IUT receive a datagram loosely and strictly routed
     to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a loose source and record route option, a
     record route option, and a strict source and record route
     option. Each source routing option indicates that all the
     required gateways have been traversed. This datagram should
     be passed by the IUT to its Remote Driver. The IUT's Remote
     Driver should request the IUT to send the reply datagram
     required by the IP Remote Driver Specification to the IP
     Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1315 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1316 strict source and record route +
          record route +
          loose source and record route

     - Can the IUT receive a datagram strictly and loosely routed
     to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a strict source and record route option, a
     record route option, and a loose source and record route
     option. Each source routing option indicates that all the
     required gateways have been traversed. This datagram should
     be passed by the IUT to its Remote Driver. The IUT's Remote
     Driver should request the IUT to send the reply datagram
     required by the IP Remote Driver Specification to the IP
     Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1316 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Test 1317 loose source and record route +
          timestamp only timestamp +
          strict source and record route

     - Can the IUT receive a datagram loosely and strictly routed
     to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a loose source and record route option, a
     timestamp only timestamp option, and a strict source and
     record route option. Each source routing option indicates
     that all the required gateways have been traversed. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1317 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1318 strict source and record route +
          timestamp only timestamp +
          loose source and record route

     - Can the IUT receive a datagram strictly and loosely routed
     to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a strict source and record route option, a
     timestamp only timestamp option, and a loose source and
     record route option. Each source routing option indicates
     that all the required gateways have been traversed. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1318 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Test 1319 loose source and record route +
          prespecified timestamp +
          strict source and record route

     - Can the IUT receive a datagram loosely and strictly routed
     to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a loose source and record route option, a
     prespecified timestamp option, and a strict source and
     record route option. Each source routing option indicates
     that all the required gateways have been traversed. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1319 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1320 strict source and record route +
          prespecified timestamp +
          loose source and record route

     - Can the IUT receive a datagram strictly and loosely routed
     to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a strict source and record route option, a
     prespecified timestamp option, and a loose source and
     record route option. Each source routing option indicates
     that all the required gateways have been traversed. This
     datagram should be passed by the IUT to its Remote Driver.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1320 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Test 1321 strict source and record route +
          prespecified timestamp +
          loose source and record route

     - Can the IUT reassemble a fragmented datagram strictly and
     loosely routed to it?

     - Action:  Send a fragmented datagram to the IP
     Implementation Under Test containing a strict source and
     record route option, a prespecified timestamp option, and a
     loose source and record route option. Each source routing
     option indicates that all the required gateways have been
     traversed. The fragments should be reassembled and the
     result passed by the IUT to its Remote Driver. The IUT's
     Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to
     the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1321 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1323 strict source and record route +
          prespecified timestamp +
          loose source and record route

     - Can the IUT reassemble a fragmented datagram strictly and
     loosely routed to it with the fragments delivered in
     reverse order?

     - Action:  Send a fragmented datagram to the IP
     Implementation Under Test containing a strict source and
     record route option, a prespecified timestamp option, and a
     loose source and record route option. Each source routing
     option indicates that all the required gateways have been
     traversed. The fragments, which are in reverse order, should
     be reassembled and the result passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1323 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Scenario File OpG2SrcBotTest:  "Two Gateway Source" datagrams

     CONFIGURATION NOTES: This scenario requires a different
configuration than that normally used because it is used for
gateway testing. DCA must provide another network directly
connected to the IUT besides the EDN so the gateway IUT lies
between two networks as required by MIL-STD-1777 section 3.1.j.

     An IP host implementation and IP Remote Driver must be
installed in the other network. The IP Remote Driver Specification
requires the implementor to provide both of these items as well as
the gateway.

     NOTICE: MIL-STD-1777 states that it "specifies a host IP."
is not clear that a gateway can or must conform to the standard.

1101      loose source and record route to IP Tester

1102      loose source and record route to host IP

ll05      loose source and record route to unreachable gateway

1109      strict source and record route to IP Tester

1111      strict source and record route to host IP

1112      strict source and record route to unreachable gateway

1115      loose source and record route +
          record route +
          strict source and record route to IP Tester

1116      strict source and record route +
          record route +
          loose source and record route to IP Tester

1117      loose source and record route +
          timestamp only timestamp +
          strict source and record route to IP Tester

1118      strict source and record route +
          timestamp only timestamp +
          loose source and record route to IP Tester

1119      loose source and record route +
          prespecified timestamp +
          strict source and record route to IP Tester

1120      strict source and record route +
          prespecified timestamp +
          loose source and record route to IP Tester
Test 1101 loose source and record route to IP Tester

     - Can the IUT forward a loosely routed datagram?

     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then arrange
     to send a reply datagram to the gateway IUT containing a
     loose source and record route option indicating that the
     datagram should be forwarded to the IP Tester. This datagram
     should be forwarded by the gateway IUT to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1101 " in its data
     field. In addition, the display should contain "LOOSE
     len=Ol5 ptr=008 00701600002 00702600002 03200200001" to
     indicate that the option was properly processed.

     Success: Display of forwarded reply datagram.

     Failure: Any response other than the display of the
     forwarded reply datagram.

Test 1102 loose source and record route to host IP

     - Can the IUT forward a loosely routed datagram?

     - Action:  Send a datagram to the gateway IUT containing a
     loose source and record route option indicating that the
     datagram should be forwarded to the host-IP. This datagram
     should be forwarded by the gateway IUT to the host IP. It
     should then be passed by the host IP to its Remote Driver.
     The host IP's Remote Driver should request the host IP to
     send the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1102 " in its data
     field.

     Success: Display of reply datagram.

     Failure: Any response other than the display of the reply
     datagram.

Test 1105 loose source and record route to unreachable gateway

     - Can the IUT handle a datagram loosely routed to an
     unreachable gateway?

     - Action:  Send a datagram to the gateway IUT containing a
     loose source and record route option indicating that the
     datagram should be forwarded to a nonexistent gateway. This
     datagram should be discarded by the gateway IUT. The gateway
     IUT may send an ICMP unreachable network or source route
     failed message to the IP Tester.

     - Verification:  If there is a response datagram displayed
     by the IP Tester, its display should contain the string
     "ICMP DESTINATION UNREACHABLE ID=01105 NETW" or the string
     "ICMP DESTINATION UNREACHABLE ID=01105 ROUT". The string
     "ident = 1105 " should not appear because this would
     indicate that the datagram was sent to the nonexistent
     gateway.

     Success: An ICMP unreachable network or source route failed
     message displayed by the IP Tester. The total lack of an IP
     Tester response datagram is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 1105 ".

Test 1109 strict source and record route to IP Tester

     - Can the IUT forward a strictly routed datagram?

     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then arrange
     to send a reply datagram to the gateway IUT containing a
     strict source and record route option indicating that the
     datagram should be forwarded to the IP Tester. This datagram
     should be forwarded by the gateway IUT to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1109 " in its data
     field. In addition, the display should contain "STRICT
     len=015 ptr=008 00701600002 00702600002 03200200001" to
     indicate that the option was properly processed.

     Success: Display of forwarded reply datagram.

     Failure: Any response other than the display of the
     forwarded reply datagram.

Test 1111 strict source and record route to host IP

     - Can the IUT forward a strictly routed datagram?

     - Action:  Send a datagram to the gateway IUT containing a
     strict source and record route option indicating that the
     datagram should be forwarded to the host IP. This datagram
     should be forwarded by the gateway IUT to the host IP.  It
     should then be passed by the host IP to its Remote Driver.
     The host IP's Remote Driver should request the host IP to
     send the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.
     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1111 " in its data
     field.

     Success: Display of reply datagram.

     Failure: Any response other than the display of the reply
     datagram.

Test 1112 strict source and record route to unreachable gateway

     - Can the IUT handle a datagram strictly routed to an
     unreachable gateway?

     - Action:  Send a datagram to the gateway IUT containing a
     strict source and record route option indicating that the
     datagram should be forwarded to a nonexistent gateway. This
     datagram should be discarded by the gateway IUT. The gateway
     IUT may send an ICMP unreachable network or source route
     failed message to the IP Tester.

     - Verification:  If there is a response datagram displayed
     by the IP Tester, its display should contain the string
     "ICMP DESTINATION UNREACHABLE ID=01112 NETW" or the string
     "ICMP DESTINATION UNREACHABLE ID=01112 ROUT". The string
     "ident = 1112 " should not appear because this would
     indicate that the datagram was sent to the nonexistent
     gateway.

     Success: An ICMP unreachable network or source route failed
     message displayed by the IP Tester. The total lack of an IP
     Tester response datagram is also an acceptable response.

     Failure: A response datagram whose IP Tester display
     contains the string "ident = 1112 ".

Test 1115 loose source and record route +
          record route +
          strict source and record route to IP Tester

     - Can the IUT forward a loosely and strictly routed datagram?

     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then send a
     reply datagram to the gateway IUT containing a loose source
     and record route option, a record route option, and a strict
     source and record route option. The loose source and record
     route option indicates that the datagram may be sent on to
     its final destination. The strict source and record route
     option indicates that it should be sent to the IP Tester
     first. This datagram should be forwarded by the gateway IUT
     to the IP Tester.
     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1115 " in its data
     field. In addition, the display should contain "LOOSE
     len=011 ptr=008 00701600002 03200200001", "STRICT len=015
     ptr=008 00701600002 00702600002 03200200001", and "ROUTE
     len=007 ptr=008 00701600002" to indicate that the options
     were properly processed.

     Check each value carefully!!

     Success: Display of forwarded reply datagram.

     Failure: Any response other than the display of the
     forwarded reply datagram.

Test 1116 strict source and record route +
          record route +
          loose source and record route to IP Tester

     - Can the IUT forward a strictly and loosely routed datagram?

     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then send a
     reply datagram to the gateway IUT containing a strict source
     and record route option, a record route option, and a loose
     source and record route option. The loose source and record
     route option indicates that the datagram may be sent on to
     its final destination. The strict source and record route
     option indicates that it should be sent to the IP Tester
     first. This datagram should be forwarded by the gateway IUT
     to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1116 " in its data
     field. In addition, the display should contain "LOOSE
     len=011 ptr=008 00701600002 03200200001", "STRICT len=015
     ptr=008 00701600002 00702600002 03200200001", and "ROUTE
     len=007 ptr=008 00701600002" to indicate that the options
     were properly processed.

     Success: Display of forwarded reply datagram.

     Failure: Any response other than the display of the
     forwarded reply datagram.

Test 1117 loose source and record route +
          timestamp only timestamp +
          strict source and record route to IP Tester

     - Can the IUT forward a loosely and strictly routed datagram?
     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then send a
     reply datagram to the gateway IUT containing a loose source
     and record route option, a timestamp only timestamp option,
     and a strict source and record route option. The loose
     source and record route option indicates that the datagram
     may be sent on to its final destination. The strict source
     and record route option indicates that it should be sent to
     the IP Tester first. This datagram should be forwarded by
     the gateway IUT to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1117 " in its data
     field.  In addition, the display should contain "LOOSE
     len=011 ptr=008 00701600002 03200200001", "STRICT len=015
     ptr=008 00701600002 00702600002 03200200001", and
     "TIMESTAMP len=012 ptr=010 ovr=00 TIMSO " to indicate that
     the options were properly processed. The line containing
     "TIMESTAMP" should contain a non-zero value after "TIMSO"
     to indicate that the option was timestamped.

     Check each value carefully!!!

     Success: Display of forwarded reply datagram.

     Failure: Any response other than the display of the
     forwarded reply datagram.

Test 1118 strict source and record route +
          timestamp only timestamp +
          loose source and record route to IP Tester

     - Can the IUT forward a strictly and loosely routed datagram?

     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then send a
     reply datagram to the gateway IUT containing a strict source
     and record route option, a timestamp only timestamp option,
     and a loose source and record route option. The loose source
     and record route option indicates that the datagram may be
     sent on to its final destination. The strict source and
     record route option indicates that it should be sent to the
     IP Tester first. This datagram should be forwarded by the
     gateway IUT to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1118 " in its data
     field. In addition, the display should contain "LOOSE
     len=011 ptr=008 00701600002 03200200001", "STRICT len=Ol5
     ptr=008 00701600002 00702600002 03200200001", and
     "TIMESTAMP len=012 ptr=010 ovr=00 TIMSO " to indicate that
     and record route option, a prespecified timestamp option,
     and a loose source and record route option. The loose source
     and record route option doesn't include the address of the
     gateway IUT, but the strict source and record route option
     does. This datagram should be forwarded by the gateway IUT
     to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1120 " in its data
     field. In addition, the display should contain "LOOSE
     len=011 ptr=004 00702600002 03200200001", "STRICT len=0l5
     ptr=008 00701600002 00702600002 03200200001", and
     "TIMESTAMP len=012 ptr=013 ovr=00 MATCH 00701600002" to
     indicate that the options were properly processed. The line
     containing "TIMESTAMP" should contain a non-zero value
     after "00701600002" to indicate that the option was
     timestamped.

     Success: Display of forwarded reply datagram.

     Failure: Any response other than the display of the
     forwarded reply datagram.

Scenario File OpG2SrcTopTest:  "Two Gateway Source" datagrams

3101      loose source and record route to IP Tester

3102      strict source and record route to disjoint gateway

3109      strict source and record route to IP Tester

3115      loose source and record route +
          record route +
          strict source and record route to IP Tester

3116      strict source and record route +
          record route +
          loose source and record route to IP Tester

3117      loose source and record route +
          timestamp only timestamp +
          strict source and record route to IP Tester

3118      strict source and record route +
          timestamp only timestamp +
          loose source and record route to IP Tester

3119      loose source and record route +
          prespecified timestamp +
          strict source and record route to IP Tester
3120      strict source and record route +
          prespecified timestamp +
          loose source and record route to IP Tester



Test 3101 loose source and record route

     - Can the IUT send a loosely routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a loose source and record route
     option. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3101 " in its data
     field.  In addition, the display should contain "LOOSE
     len=015 ptr=004 00702600002 14300200001 03200200001" to
     indicate that the option was not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 3102 strict source and record route to IP Tester

     - Can the IUT detect it shouldn't send a defective strictly
     routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a strict source and record route
     option. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification. The IUT is required to inform its
     Remote Driver that the request is invalid because the first
     gateway is not on the IUT's network. The Remote Driver
     should then request the IUT to send an IP Remote Driver
     Specification error message to the IP Tester.

     - Verification: The IP Tester will display the error
     message datagram that must contain "ident = 3101 error" in
     its 18-byte data field.

     Success: Display of error message datagram.

     Failure: Any response other than the display of the error
     message datagram.
Test 3109 strict source and record route

     - Can the IUT send a strictly routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a strict source and record route
     option. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3109 " in its data
     field. In addition, the display should contain "STRICT
     len=015 ptr=004 00702600002 14300200001 03200200001" to
     indicate that the option was not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 3115 loose source and record route +
          record route +
          strict source and record route to IP Tester

     - Can the IUT send a loosely and strictly routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a loose source and record route
     option, a record route option, and a strict source and
     record route option. This datagram should be passed by the
     IUT to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3115 " in its data
     field. In addition, the display should contain "LOOSE
     len=011 ptr=004 00702600002 03200200001", "STRICT len=015
     ptr=004 00702600002 14300200001 03200200001", "ROUTE
     len=007 ptr=004 00000000000" to indicate that the options
     were not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 3116 strict source and record route +
          record route +
          loose source and record route to IP Tester
     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3103 " in its data
     field. In addition, the display should contain "LOOSE
     len=019 ptr=004 00702600002 14300200001 00702600002
     03200200001" to indicate that the option was not improperly
     processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 3110 strict source and record route

     - Can the IUT send a strictly routed datagram?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing a Remote Driver command request for the IUT to send
     a datagram with a strict source and record route option. This
     datagram should be passed by the IUT to its Remote Driver. The
     IUT's Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to the
     IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3110 " in its data
     field. In addition, the display should contain "STRICT
     len=019 ptr=004 00702600002 14300200001 00702600002
     03200200001" to indicate that the option was not improperly
     processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Scenario File OpG6DstBotTest: "Six Gateway Destination" datagram

1306      loose source and record route



Test 1306 loose source and record route

     - Can the IUT receive a datagram loosely routed to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a loose source and record route option
     indicating that all the required gateways have been
     traversed. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.
     - Can the IUT send a strictly and loosely routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a strict source and record route
     option, a record route option, and a loose source and record
     route option. This datagram should be passed by the IUT to
     its Remote Driver. The IUT's Remote Driver should request
     the IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3116 " in its data
     field.  In addition, the display should contain "LOOSE
     len=011 ptr=004 00702600002 03200200001", "STRICT len=015
     ptr=004 00702600002 14300200001 03200200001", "ROUTE
     len=007 ptr=004 00000000000" to indicate that the options
     were not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 3117 loose source and record route +
          timestamp only timestamp +
          strict source and record route to IP Tester

     - Can the IUT send a loosely and strictly routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a loose source and record route
     option, a timestamp only timestamp option, and a strict
     source and record route option. This datagram should be
     passed by the IUT to its Remote Driver. The IUT's Remote
     Driver should request the IUT to send the reply datagram
     required by the IP Remote Driver Specification to the IP
     Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3117 " in its data
     field.  In addition, the display should contain "LOOSE
     len=011 ptr=004 14300200001 03200200001", "STRICT len=015
     ptr=004 00702600002 14300200001 03200200001", "TIMESTAMP
     len=012 ptr=005 ovr=00 TIMSO 00000000000 00000000000" to
     indicate that the options were not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Test 3118 strict source and record route +
          timestamp only timestamp +
          loose source and record route to IP Tester

     - Can the IUT send a strictly and loosely routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a strict source and record route
     option, a timestamp only timestamp option, and a loose
     source and record route option. This datagram should be
     passed by the IUT to its Remote Driver. The IUT's Remote
     Driver should request the IUT to send the reply datagram
     required by the IP Remote Driver Specification to the IP
     Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3118 " in its data
     field.  In addition, the display should contain "LOOSE
     len=011 ptr=004 14300200001 03200200001", "STRICT len=015
     ptr=004 00702600002 14300200001 03200200001", "TIMESTAMP
     len=012 ptr=005 ovr=00 TIMSO 00000000000 00000000000" to
     indicate that the options were not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 3119 loose source and record route +
          prespecified timestamp +
          strict source and record route to IP Tester

     - Can the IUT send a loosely and strictly routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a loose source and record route
     option, a prespecified timestamp option, and a strict source
     and record route option. This datagram should be passed by
     the IUT to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3119 " in its data
     field. In addition, the display should contain "LOOSE
     len=011 ptr=004 00702600002 03200200001", "STRICT len=015
     ptr=004 00702600002 14300200001 03200200001", "TIMESTAMP
     len=012 ptr=005 ovr=00 MATCH 00702600002 00000000000" to
     indicate that the options were not improperly processed.

     Success: Display of reply datagram requested to be sent.
     Failure: Any response other than the display of the
     requested reply datagram.

Test 3120 strict source and record route +
          prespecified timestamp +
          loose source and record route to IP Tester

     - Can the IUT send a strictly and loosely routed datagram?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a Remote Driver command request for the IUT
     to send a datagram with a strict source and record route
     option, a prespecified timestamp option, and a loose source
     and record route option. This datagram should be passed by
     the IUT to its Remote Driver. The IUT's Remote Driver should
     request the IUT to send the reply datagram required by the
     IP Remote Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3120 " in its data
     field. In addition, the display should contain "LOOSE
     len=011 ptr=004 00702600002 03200200001", "STRICT len=015
     ptr=004 00702600002 14300200001 03200200001", "TIMESTAMP
     len=012 ptr=005 ovr=00 MATCH 00702600002 00000000000" to
     indicate that the options were not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Scenario File OpG3DstBotTest:  "Three Gateway Destination" datagrams

1303      loose source and record route

1307      fragmented datagram with loose source and record route

1310      strict source and record route

1312      fragmented datagram with strict source and record route



Test 1303 loose source and record route

     - Can the IUT receive a datagram loosely routed to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a loose source and record route option
     indicating that all the required gateways have been
     traversed. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.
     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1303 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1307 fragmented datagram containing a loose source and record
          route option

     - Can the IUT reassemble fragmented datagram containing a
       loose source and record route option?

     - Action:  Send a datagram containing a loose source and
     record route option fragmented into two fragments to the IP
     Implementation Under Test. These fragments should be
     reassembled and the result passed by the IUT to its Remote
     Driver. The IUT's Remote Driver should request the IUT to
     send the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1307 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1310 strict source and record route

     - Can the IUT receive a datagram strictly routed to it?

     - Action:  Send a datagram to the IP Implementation Under
     Test containing a strict source and record route option
     indicating that all the required gateways have been
     traversed. This datagram should be passed by the IUT to its
     Remote Driver. The IUT's Remote Driver should request the
     IUT to send the reply datagram required by the IP Remote
     Driver Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1310 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Test 1312 fragmented datagram containing a strict source and record
          route option

     - Can the IUT reassemble fragmented datagram containing a
     strict source and record route option?

     - Action:  Send a datagram containing a strict source and
     record route option fragmented into two fragments to the IP
     Implementation Under Test. These fragments should be
     reassembled and the result passed by the IUT to its Remote
     Driver. The IUT's Remote Driver should request the IUT to
     send the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1312 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Scenario File OpG3SrcBotTest:  "Three Gateway Source" datagrams

     CONFIGURATION NOTES: This scenario requires a different
configuration than that normally used because it is used for
gateway testing. DCA must provide another network directly
connected to the IUT besides the EDN so the gateway IUT lies
between two networks as required by MIL-STD-1777 section 3.1.j.

     An IP host implementation and IP Remote Driver must be
installed in the other network. The IP Remote Driver Specification
requires the implementor to provide both of these items as well as
the gateway.

     NOTICE: MIL-STD-1777 states that it "specifies a host IP." It
is not clear that a gateway can or must conform to the standard.

1103      loose source and record route to IP Tester

1104      loose source and record route to host IP

1107      strict source and record route to IP Tester

1110      strict source and record route to host IP



Test 1103 loose source and record route to IP Tester

     - Can the IUT forward a loosely routed datagram?
     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then arrange
     to send a datagram to the gateway IUT containing a loose
     source and record route option indicating that the datagram
     should be forwarded to the IP Tester. This datagram should
     be forwarded by the gateway IUT to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1103 " in its data
     field.  In addition, the display should contain "LOOSE
     len=019 ptr=010 00701600002 00702600002 14300200001
     03200200001" to indicate that the option was properly
     processed.

     Success: Display of forwarded reply datagram.

     Failure: Any response other than the display of the
     forwarded reply datagram.

Test 1104 loose source and record route to host IP

     - Can the IUT forward a loosely routed datagram?

     - Action:  Send a datagram to the gateway IUT containing a
     loose source and record route option indicating that the
     datagram should be forwarded to the host IP. This datagram
     should be forwarded by the gateway IUT to the host IP. It
     should then be passed by the host IP to its Remote Driver.
     The host IP's Remote Driver should request the host IP to
     send the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1104 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Test 1107 strict source and record route to IP Tester

     - Can the IUT forward a strictly routed datagram?

     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then arrange
     to send a datagram to the gateway IUT containing a strict
     source and record route option indicating that the datagram
     should be forwarded to the IP Tester. This datagram should
     be forwarded by the gateway IUT to the IP Tester.
     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1306 in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Scenario File OpG6SrcBotTest:  "Six Gateway Source" datagrams

     CONFIGURATION NOTES: This scenario requires a different
configuration than that normally used because it is used for
gateway testing. DCA must provide another network directly
connected to the IUT besides the EDN so the gateway IUT lies
between two networks as required by MIL-STD-1777 section 3.1.j.

     An IP host implementation and IP Remote Driver must be
installed in the other network. The IP Remote Driver Specification
requires the implementor to provide both of these items as well as
the gateway.

     NOTICE: MIL-STD-1777 states that it "specifies a host IP." It
is not clear that a gateway can or must conform to the standard.

1106      loose source and record route to IP Tester

1121      loose source and record route to host IP



Test 1106 loose source and record route to IP Tester

     - Can the IUT forward a loosely routed datagram?

     - Action:  Send a datagram to the host IP via the gateway
     IUT. This should be passed to the host IP's Remote Driver.
     The Remote Driver and conformant host IP should then arrange
     to send a datagram to the gateway IUT containing a loose
     source and record route option indicating that the datagram
     should be forwarded to the IP Tester. This datagram should
     be forwarded by the gateway IUT to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1106 " in its data
     field. In addition, the display should contain "LOOSE
     len=027 ptr=010 00701600002 00702600002 14300200001
     00702600002 14300200001 00702600002 03200200001" to
     indicate that the option was properly processed.

     Success: Display of forwarded reply datagram.

     Failure: Any response other than the display of the
     forwarded reply datagram.
Test 1121 loose source and record route to host IP

     - Can the IUT forward a loosely routed datagram?

     - Action:  Send a datagram to the gateway IUT containing a
     loose source and record route option indicating that the
     datagram should be forwarded to the host IP. This datagram
     should be forwarded by the gateway IUT to the host IP.  It
     should then be passed by the host IP to its Remote Driver.
     The host IP's Remote Driver should request the host IP to
     send the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 1121 " in its 13-byte
     data field.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.

Scenario File OpG6SrcTopTest: "Six Gateway Source" datagram

Test 3106 loose source and record route



Test 3106 loose source and record route

     - Can the IUT send a loosely routed datagram?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing a Remote Driver command request for the IUT to send
     a datagram with a loose source and record route option. This
     datagram should be passed by the IUT to its Remote Driver. The
     IUT's. Remote Driver should request the IUT to send the reply
     datagram required by the IP Remote Driver Specification to the
     IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 3106 " in its data
     field.  In addition, the display should contain "LOOSE
     len=03l ptr=004 00702600002 14300200001 00702600002
     14300200001 00702600002 14300200001 03200200001" to
     indicate that the option was not improperly processed.

     Success: Display of reply datagram requested to be sent.

     Failure: Any response other than the display of the
     requested reply datagram.
Scenario File OptBdBotTest:  "Bottom-up Bad Option Field" datagrams

2000      security option without copy bit set

2001      loose source and record route option without copy bit set

2002      timestamp option without bit 6 set

2003      stream ID option without copy bit set

2004      strict source and record route option without copy bit
          set

2005      "option" with option type of 77 octal

2006      "option" with option type of 101 octal

2007      "option" with option type of 177 octal

2008      record route option with copy bit set

2009      prespecified timestamp option with copy bit set

2010      end of options list option with copy bit set

2011      no operation option with copy bit set

2012      ordinary datagram after bad option type tests

2013      truncated security option

2014      security option length bumped by 1

2015      security option one byte too long

2016      security option one byte too short

2017      security option length of 0

2018      security option length of 377 octal

2019      security option length of 353 octal

2020      security option length of 177 octal

2021      security option length of 200 octal

2022      security option length of 213 octal

2023      security option duplicated

2024      two security options (unclassified, secret)

2025      two security options (secret, unclassified)
2026      security option with an invalid security level

2027      ordinary datagram after bad security option tests

2028      truncated stream identification option

2029      stream identification option length bumped by 1

2030      stream identification option one byte too long

2031      stream identification option one byte too short

2032      stream identification option length of 0

2033      stream identification option length of 377 octal

2034      stream identification option length of 354 octal

2035      stream identification option length of 177 octal

2036      stream identification option length of 200 octal

2037      stream identification option length of 204 octal

2038      stream identification option duplicated

2039      two different stream identification options

2040      bad security level + good stream identification option

2041      bad security length + good stream identification iption

2042      ordinary datagram after bad stream ID option tests

2043      truncated record route option

2044      record route option length bumped by 1

2045      record route option one byte too long

2046      record route option one byte too short

2047      record route option length of 0

2048      record route option length of 377 octal

2049      record route option length of 353 octal

2050      record route option length of 177 octal

2051      record route 	-Action:  Send a datagram to th      record route option length of 207 octal
2053      record route option pointer bumped by 1

2054      record route option pointer one short

2055      record route option pointer of 300 octal

2056      record route option pointer of 174 octal

2057      record route option pointer with bad option length and
          option pointer

2058      record route option with bad option pointer

2059      larger record route option with bad option pointer

2060      record route option duplicated

2061      two different record route options

2062      ordinary datagram after bad record route option tests

2063      truncated timestamp option

2064      timestamp option length bumped by 1

2065      timestamp option one byte too long

2066      timestamp option one byte too short

2067      timestamp option length of 0

2068      timestamp option length of 374 octal

2069      timestamp option  length of 354 octal

2070      timestamp option length of 174 octal

2071      timestamp option length of 200 octal

2072      timestamp option length of 210 octal

2073      timestamp option pointer bumped by 1

2074      timestamp option pointer one short

2075      timestamp option pointer of 301 octal

2076      timestamp option pointer of 175 octal

2077      timestamp option pointer with bad option length and
          option pointer

2078      timestamp option with bad option pointer
2079      larger timestamp option with bad option pointer

2080      timestamp option duplicated

2081      two different timestamp options

2082      timestamp option with bad timestamp option format

2083      truncated timestamp option

2084      timestamp option length bumped by 1

2085      timestamp option one byte too long .      .

2086      timestamp option four bytes too short

2087      timestamp option four bytes too short

2088      timestamp option length of 374 octal

2089      timestamp option length of 354 octal

2090      timestamp option length of 174 octal

2091      timestamp option length of 200 octal

2092      timestamp option length of 214 octal

2093      timestamp option pointer bumped by 4

2094      timestamp option pointer four short

2095      timestamp option pointer of 305 octal

2096      timestamp option pointer of 175 octal

2097      timestamp option pointer with bad option length and
          option pointer

2098      timestamp option with bad option pointer

2099      ordinary datagram after bad timestamp option tests



Test 2000 security option without copy bit set

     - Can the IUT interpret a bad security option?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing a security option without the copy bit set. The IUT
     may discard the datagram and send an optional ICMP Parameter
     Problem message.
     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2000
     or "ICMP PARAMETER PROBLEM id=02000".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2000 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2001 loose source and record route option without copy bit set

     - Can the IUT interpret a bad loose source and record route
     option?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing a loose source and record route option without the
     copy bit set. The IUT may discard the datagram and send an
     optional ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2001
     or "ICMP PARAMETER PROBLEM id=02001".

     Success: An ICMP Parameter Problem m.essage, a reply datagram
     containing "ident = 2001 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2002 timestamp option without bit 6 set

     - Can the IUT interpret a bad timestamp option?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing a timestamp option without bit 6 set. The IUT may
     discard the datagram and send an optional ICMP Parameter
     Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.
     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2002
     or "ICMP PARAMETER PROBLEM id=02002".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2002 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2003 stream ID option without copy bit set

     - Can the IUT interpret a bad security option? -

     - Action:  Send a datagram to the IP Implementation Under Test
     containing a stream identification option without the copy bit
     set. The IUT may discard the datagram and send an optional
     ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2003
     or "ICMP PARAMETER PROBLEM id=02003".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2003 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2004 strict source and record route option without copy bit
          set

     - Can the IUT interpret a bad strict source and record route
     option?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing a strict source and record route option without the
     copy bit set. The IUT may discard the datagram and send an
     optional ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2004
     or "ICMP PARAMETER PROBLEM id=02004".
     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2004"  or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2005 "option" with option type of 77 octal

     - Can the IUT interpret a bad option type?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing an illegal "option" with option type of 77 octal.
     The IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a response datagram displayed by
     the IP Tester, its display ought to contain either "ident =
     2005 " or "ICMP PARAMETER PROBLEM id=02005".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2005", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2006 "option" with option type of 101 octal

     - Can the IUT interpret a bad option type?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing an illegal "option" with option type of 101 octal.
     The IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2006 "
     or "ICMP PARAMETER PROBLEM id=02006'.

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2006", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.
Test 2007 "option' with option type of 177 octal

    - Can the IUT interpret a bad option type?

    - Action:  Send a datagram to the IP Implementation Under Test
    containing an illegal "option' with option type of 177 octal.
    The IUT may discard the datagram and send an optional ICMP
    Parameter Problem message.

    The IUT may pass the datagram to its Remote Driver instead.
    The IUT's Remote Driver should request the IUT to send the
    reply datagram required by the IP Remote Driver Specification -
    to the IP Tester.

    - Verification:  If there is a datagram displayed by the IP
    Tester, its display ought to contain either "ident = 2007
    or "ICMP PARAMETER PROBLEM id=02007".

    Success: An ICMP Parameter Problem message, a reply datagram
    containing "ident = 2007 ", or nothing.

    Failure: An IP Tester display of a datagram other than an
    ICMP Parameter Problem message or reply datagram.

Test 2008 record route option with copy bit set

    - Can the IUT interpret a bad record route option?

    - Action:  Send a datagram to the IP Implementation Under Test
    containing a record route option with the copy bit set. The
    IUT may discard the datagram and send an optional ICMP
    Parameter Problem message.

    The IUT may pass the datagram to its Remote Driver instead.
    The IUT's Remote Driver should request the IUT to send the
    reply datagram required by the IP Remote Driver Specification
    to the IP Tester.

    - Verification:  If there is a datagram displayed by the IP
    Tester, its display ought to contain either "ident = 2008 "
    or "ICMP PARAMETER PROBLEM id=02008".

    Success: An ICMP Parameter Problem message, a reply datagram
    containing "ident = 2008 ", or nothing.

    Failure: An IP Tester display of a datagram other than an
    ICMP Parameter Problem message or reply datagram.

Test 2009 prespecified timestamp option with copy bit set

    - Can the IUT interpret a bad prespecified timestamp option?
    - Actio-n:  Send a datagram to the IP Implementation Under Test
    containing a prespecified timestamp option with the copy bit
    set. The IUT may discard the datagram and send an optional
    ICMP Parameter Problem message.

    The IUT may pass the datagram to its Remote Driver instead.
    The IUT's Remote Driver should request the IUT to send the
    reply datagram required by the IP Remote Driver Specification
    to the IP Tester.

    - Verification: If there is a datagram displayed by the IP
    Tester, its display ought to contain either "ident = 2009"
    or "ICMP PARAMETER PROBLEM id=02009".

    Success: An ICMP Parameter Problem message, a reply datagram
    containing "ident = 2009 ", or nothing.

    Failure: An IP Tester display of a datagram other than an
    ICMP Parameter Problem message or reply datagram.

Test 2010 end of options list option with copy bit set

    - Can the IUT interpret a bad end of options list option?

    - Action:  Send a datagram to the IP Implementation Under Test
    containing a end of options list option with the copy bit set.
    The IUT may discard the datagram and send an optional ICMP
    Parameter Problem message.

    The IUT may pass the datagram to its Remote Driver instead.
    The IUT's Remote Driver should request the IUT to send the
    reply datagram required by the IP Remote Driver SpecificatIon
    to the IP Tester.

    - Verification:  If there is a datagram displayed by the IP
    Tester, its display ought to contain either "ident = 2010
    or "ICMP PARAMETER PROBLEM id=02010".

    Success: An ICMP Parameter Problem message, a reply datagram
    containing "ident = 2010 ", or nothing.

    Failure: An IP Tester display of a datagram other than an
    ICMP Parameter Problem message or reply datagram.

Test 2011 no operation option with copy bit set

    - Can the IUT interpret a bad no operation option?

    - Action:  Send a datagram to the IP Implementation Under Test
    containing a no operation option with the copy bit set. Tne
    IUT may discard the datagram and send an optional ICMP
    Parameter Problem message.
    The IUT may pass the datagram to its Remote Driver instead.
    The IUT's Remote Driver should request the IUT to send the
    reply datagram required by the IP Remote Driver Specification
    to the IP Tester.

    - Verification: If there is a datagram displayed by the IP
    Tester, its display ought to contain either "ident = 2011
    or "ICMP PARAMETER PROBLEM id=02011".

    Success: An ICMP Parameter Problem message, a reply datagram
    containing "ident = 2011 ", or nothing.

    Failure: An IP Tester display of a datagram other than an
    ICMP Parameter Problem message or reply datagram.

Test 2012 ordinary datagram after bad option type tests

    - Can the IUT send a datagram after processing nastygrams?

    - Action:  Send a datagram to the IP Implementation Under
    Test. This datagram should be passed by the IUT to its Remote
    Driver. The IUT's Remote Driver should request the IUT to send
    the reply datagram required by the IP Remote Driver
    Specification to the IP Tester.

    - Verification: The IP Tester will disp-lay the reply
    datagram that must contain "ident = 2012 " in its 13-byte
    data field.

    Success: A reply datagram containing "ident = 2012 ".

    Failure: Any response other than the display of the
    requested reply datagram. The actual failure probably
    occurred during tests 2000-2011.

Test 2013 truncated security option

    - Can the IUT interpret a truncated security option?

    - Action:  Send a datagram to the IP Implementation Under
    Test with a 12-byte option field. The first two bytes are no
    operation options followed by a truncated security option.
    The IUT may discard the datagram and send an optional ICMP
    Parameter Problem message.

    The IUT may pass the datagram to its Remote Driver instead.
    The IUT's Remote Driver should request the IUT to send the
    reply datagram required by the IP Remote Driver Specification
    to the IP Tester.

    - Verification:  If there is a datagram displayed by the IP
    Tester, its display ought to contain either "ident = 2013 "
    or "ICMP PARAMETER PROBLEM id=02013".
     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2013 "  or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2014 security option length bumped by 1

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with a 12-byte option field. The first byte is a no operation
     option. This is followed by an unclassified security option
     whose option length has been bumped by 1. The IUT may discard
     the datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2014 "
     or "ICMP PARAMETER PROBLEM id=02014".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2014 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2015 security option one byte too long

     - Can the IUT interpret a defective option?

     - Action:  Send a datagram to the IP Implementation Under Test
     with a 12-byte option field. This consists of an unclassified
     security option that is one byte too long. The IUT may discard
     the datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2015 "
     or "ICMP PARAMETER PROBLEM id=02015".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2015 ", or nothing.
     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2016 security option one byte too short

     - Can the IUT interpret a defective option?

     - Action:  Send a datagram to the IP Implementation Under Test
     with a 12-byte option field. This consists of an unclassified
     security option that is one byte too short followed by an an
     end of option list option and one byte of padding. The IUT may
     discard the datagram and send an optional ICMP Parameter
     Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2016"
     or "ICMP PARAMETER PROBLEM id=02016".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2016 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2017 security option length of 0

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under
     Test with a 12-byte option field. This contains a security
     option with an option length of 0. The IUT may discard the
     datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2017 "
     or "ICMP PARAMETER PROBLEM id=02017".

     Success: An ICMP Parameter Problem message, a reply
     datagram containing "ident = 2017 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.
Test 2018 security option length of 377 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under
     Test with an option field. This contains a security option
     with an option length of 377 octal. The IUT may discard the
     datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2018 "
     or "ICMP PARAMETER PROBLEM id=02018".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2018 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2019 security option length of 353 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a security option with an
     option length of 353 octal. The IUT may discard the datagram
     and send an optional ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2019 "
     or "ICMP PARAMETER PROBLEM id=02019".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2019 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2020 security option length of 177 octal

     - Can the IUT interpret a defective option length?
       Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a security option with an
     option length of 177 octal. The IUT may discard the datagram
     and send an optional ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester,  its display ought to contain either "ident = 2020 "    .
     or "ICMP PARAMETER PROBLEM id=02020".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2020 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2021 security option length of 200 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a security option with an
     option length of 200 octal. The IUT may discard the datagram
     and send an optional ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2021 "
     or "ICMP PARAMETER PROBLEM id=02021".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2021 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2022 security option length of 213 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a security option with an
     option length of 213 octal (sign bit set).   The IUT may
     discard the datagram and send an optional ICMP Parameter
     Problem message.
     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2022 "'
     or "ICMP PARAMETER PROBLEM id=02022".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2022 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2023 security option duplicated

     - Can the IUT interpret a duplicated security option?

     - Action:  Send a datagram to the IP Implementation Under Test
     whose option field contains two identical security options.
     The IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2023 "
     or "ICMP PARAMETER PROBLEM id=02023".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2023 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2024 two security options

     - Can the IUT interpret two options of the same type?

     - Action:  Send a datagram to the IP Implementation Under Test
     whose option field contains two different security options.
     The IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.
     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2024 "
     or "ICMP PARAMETER PROBLEM id=02024".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2024 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2025 two security options

     - Can the IUT interpret two options of the same type?

     - Action:  Send a datagram to the IP Implementation Under Test
     whose option field contains two different security options.
     This test differs from test 2024 in that the order of the
     options has been reversed. The IUT may discard the datagram
     and send an optional ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2025 "
     or "ICMP PARAMETER PROBLEM id=02025".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2025 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2026 security option with an invalid security level

     - Can the IUT interpret a bad security option?

     - Action:  Send a datagram to the IP Implementation Under Test
     containing a security option with an invalid security level.
     The IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2026 "
     or "ICMP PARAMETER PROBLEM id=02026".
     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2026 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2027 ordinary datagram after bad security option tests

     - Can the IUT send a datagram after processing nastygrams?

     - Action:  Send a datagram to the IP Implementation Under
     Test. This datagram should be passed by the IUT to its Remote
     Driver. The IUT's Remote Driver should request the IUT to send
     the reply datagram required by the IP Remote Driver
     Specification to the IP Tester.

     - Verification: The IP Tester will display the reply
     datagram that must contain "ident = 2027 " in its 13-byte
     data field.

     Success: A reply datagram containing "ident = 2027 ".

     Failure: Any response other than the display of the
     requested reply datagram. The actual failure probably
     occurred during tests 2013-2026.

Test 2028 truncated stream identification option

     - Can the IUT interpret a truncated stream ID option?

     - Action:  Send a datagram to the IP Implementation Under Test
     with a 4-byte option field. The first byte is a no operation
     option followed by a truncated stream identification option.
     The IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2028 "
     or "ICMP PARAMETER PROBLEM id=02028".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2028 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2029 stream identification option length bumped by 1

     - Can the IUT interpret a defective option length?
     - Action:  Send a datagram to the IP Implementation Under Test
     with a 4-byte option field consisting of a stream ID option
     whose option length has been bumped by 1. The IUT may discard
     the datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2029 "
     or "ICMP PARAMETER PROBLEM id=02029".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2029 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2030 stream identification option one byte too long

     - Can the IUT interpret a defective option?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an 8-byte option field. This contains a stream ID option
     that is one byte too long. The IUT may discard the datagram
     and send an optional ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2030 "
     or "ICMP PARAMETER PROBLEM id=02030".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2030 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2031 stream identification option one byte too short

     - Can the IUT interpret a defective option?       .

     - Action:  Send a datagram to the IP Implementation Under Test
     with a 4-byte option field. This consists of a stream ID
     option that is one byte too short followed by an an end of
     option list option. The IUT may discard the datagram and send
     an optional ICMP Parameter Problem message.
     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2031 "
     or "ICMP PARAMETER PROBLEM id=02031".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2031 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2032 stream identification option length of 0

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with a 4-byte option field. This contains a stream ID option
     with an option length of 0. The IUT may discard the datagram
     and send an optional ICMP Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2032
     or "ICMP PARAMETER PROBLEM id=02032".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2032 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2033 stream identification option length of 377 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a stream identification
     option with an option length of 377 octal. The IUT may discard
     the datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.
     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2033"
     or "ICMP PARAMETER PROBLEM id=02033".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2033 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2034 stream identification option length of 354 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a stream identification
     option with an option length of 354 octal. The IUT may discard
     the datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specificatiom
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2034"
     or "ICMP PARAMETER PROBLEM id=02034".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2034 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2035 stream identification option length of 177 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a stream identification
     option with an option length of 177 octal. The IUT may discard
     the datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2035
     or "ICMP PARAMETER PROBLEM id=02035".
     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2035 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2036 stream identification option length of 200 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a stream identification
     option with an option length of 200 octal. The IUT may discard
     the datagram and send an optional ICMP Parameter Problem
     message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2036 "
     or "ICMP PARAMETER PROBLEM id=02036".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2036 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2037 stream identification option length of 204 octal

     - Can the IUT interpret a defective option length?

     - Action:  Send a datagram to the IP Implementation Under Test
     with an option field. This contains a stream identification
     option with an option length of 204 octal (sign bit set).   The
     IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification:  If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2037"
     or "ICMP PARAMETER PROBLEM id=02037".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2037 ", or nothing.
     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2038 stream identification option duplicated

     - Can the IUT interpret a duplicated stream ID option?

     - Action:  Send a datagram to the IP Implementation Under Test
     whose option field contains two identical stream ID options.
     The IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2038 "
     or "ICMP PARAMETER PROBLEM id=02038".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2038 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2039 two stream identification options

     - Can the IUT interpret two options of the same type?

     - Action:  Send a datagram to the IP Implementation Under Test
     whose option field contains two different stream ID options.
     The IUT may discard the datagram and send an optional ICMP
     Parameter Problem message.

     The IUT may pass the datagram to its Remote Driver instead.
     The IUT's Remote Driver should request the IUT to send the
     reply datagram required by the IP Remote Driver Specification
     to the IP Tester.

     - Verification: If there is a datagram displayed by the IP
     Tester, its display ought to contain either "ident = 2039 "
     or "ICMP PARAMETER PROBLEM id=02039".

     Success: An ICMP Parameter Problem message, a reply datagram
     containing "ident = 2039 ", or nothing.

     Failure: An IP Tester display of a datagram other than an
     ICMP Parameter Problem message or reply datagram.

Test 2040 bad security option plus good stream identification
          option
